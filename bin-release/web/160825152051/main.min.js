var dragonBones;!function(t){var e=function(){function t(){this.hashCode=t._hashCode++}var e=(__define,t),a=e.prototype;return t._returnObject=function(e){var a=String(e.constructor),i=null==t._maxCountMap[a]?t._defaultMaxCount:t._maxCountMap[a],n=t._poolsMap[a]=t._poolsMap[a]||[];if(n.length<i){if(!(n.indexOf(e)<0))throw new Error;n.push(e)}},t.toString=function(){throw new Error},t.setMaxCount=function(e,a){if((0>a||a!=a)&&(a=0),e){var i=String(e);t._maxCountMap[i]=a;var n=t._poolsMap[i];n&&n.length>a&&(n.length=a)}else{t._defaultMaxCount=a;for(var i in t._poolsMap)if(null!=t._maxCountMap[i]){var n=t._poolsMap[i];n.length>a&&(n.length=a)}}},t.clearPool=function(e){if(void 0===e&&(e=null),e){var a=t._poolsMap[String(e)];a&&a.length&&(a.length=0)}else for(var i in t._poolsMap){var a=t._poolsMap[i];a.length=0}},t.borrowObject=function(e){var a=t._poolsMap[String(e)];if(a&&a.length)return a.pop();var i=new e;return i._onClear(),i},a.returnToPool=function(){this._onClear(),t._returnObject(this)},t._hashCode=0,t._defaultMaxCount=5e3,t._maxCountMap={},t._poolsMap={},t}();t.BaseObject=e,egret.registerClass(e,"dragonBones.BaseObject")}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(e){function a(){e.call(this),this._animations={},this._animationNames=[],this._animationStates=[]}__extends(a,e);var i=__define,n=a,r=n.prototype;return a._sortAnimationState=function(t,e){return t.layer>e.layer?1:-1},a.toString=function(){return"[class dragonBones.Animation]"},r._onClear=function(){this.timeScale=1,this._animationStateDirty=!1,this._timelineStateDirty=!1,this._armature=null,this._isPlaying=!1,this._time=0,this._lastAnimationState=null;for(var t in this._animations)delete this._animations[t];this._animationNames.length&&(this._animationNames.length=0);for(var t=0,e=this._animationStates.length;e>t;++t)this._animationStates[t].returnToPool();this._animationStates.length=0},r._fadeOut=function(t,e,a,i,n){var r=0,s=this._animationStates.length,o=null;switch(i){case 0:break;case 1:for(;s>r;++r)o=this._animationStates[r],o.layer==e&&o.fadeOut(t,n);break;case 2:for(;s>r;++r)o=this._animationStates[r],o.group==a&&o.fadeOut(t,n);break;case 4:for(;s>r;++r)o=this._animationStates[r],o.fadeOut(t,n);break;case 3:for(;s>r;++r)o=this._animationStates[r],o.layer==e&&o.group==a&&o.fadeOut(t,n)}},r._updateFFDTimelineStates=function(){for(var t=0,e=this._animationStates.length;e>t;++t)this._animationStates[t]._updateFFDTimelineStates()},r._advanceTime=function(t){var e=this;if(e._isPlaying){0>t&&(t=-t);var a=e._animationStates.length;if(1==a){var i=e._animationStates[0];i._isFadeOutComplete?(i.returnToPool(),e._animationStates.length=0,e._animationStateDirty=!0,e._lastAnimationState=null):(e._timelineStateDirty&&i._updateTimelineStates(),i._advanceTime(t,1,0))}else if(a>1)for(var n=e._animationStates[0]._layer,r=1,s=0,o=1,l=0,h=0;a>l;++l){var i=e._animationStates[l];i._isFadeOutComplete?(h++,i.returnToPool(),e._animationStateDirty=!0,e._lastAnimationState==i&&(l-h>=0?e._lastAnimationState=e._animationStates[l-h]:e._lastAnimationState=null)):(h>0&&(e._animationStates[l-h]=i),n!=i._layer&&(n=i._layer,s>=r?r=0:r-=s,s=0),e._timelineStateDirty&&i._updateTimelineStates(),i._advanceTime(t,r,o),0!=i._weightResult&&(s+=i._weightResult,o++)),l==a-1&&h>0&&(e._animationStates.length-=h)}e._timelineStateDirty=!1}},r.reset=function(){this._isPlaying=!1,this._lastAnimationState=null;for(var t=0,e=this._animationStates.length;e>t;++t)this._animationStates[t].returnToPool();this._animationStates.length=0},r.stop=function(t){if(void 0===t&&(t=null),t){var e=this.getState(t);e&&e.stop()}else this._isPlaying=!1},r.play=function(t,e){void 0===t&&(t=null),void 0===e&&(e=-1);var a=null;if(t)a=this.fadeIn(t,0,e,0,null,4);else if(this._lastAnimationState)this._isPlaying?a=this.fadeIn(this._lastAnimationState.name,0,e,0,null,4):this._isPlaying=!0;else{var i=this._armature.armatureData.defaultAnimation;i&&(a=this.fadeIn(i.name,0,e,0,null,4))}return a},r.fadeIn=function(e,i,n,r,s,o,l,h,_,u){void 0===i&&(i=-1),void 0===n&&(n=-1),void 0===r&&(r=0),void 0===s&&(s=null),void 0===o&&(o=3),void 0===l&&(l=!1),void 0===h&&(h=!0),void 0===_&&(_=!0),void 0===u&&(u=!0);var m=this._animations[e];if(!m)return this._time=0,console.warn("No animation."," Armature: "+this._armature.name," Animation: "+e),null;this._time!=this._time&&(console.warn("Error time.",this._time),this._time=0),this._isPlaying=!0,(i!=i||0>i)&&(i=this._lastAnimationState?m.fadeInTime:0),0>n&&(n=m.playTimes),this._fadeOut(i,r,s,o,_),this._lastAnimationState=t.BaseObject.borrowObject(t.AnimationState),this._lastAnimationState._layer=r,this._lastAnimationState._group=s,this._lastAnimationState.additiveBlending=l,this._lastAnimationState.displayControl=h,this._lastAnimationState._fadeIn(this._armature,m.animation||m,e,n,m.position,m.duration,this._time,1/m.scale,i,u),this._animationStates.push(this._lastAnimationState),this._animationStateDirty=!0,this._time=0,this._animationStates.length>1&&this._animationStates.sort(a._sortAnimationState);for(var f=this._armature.getSlots(),c=0,d=f.length;d>c;++c){var g=f[c];if(g.inheritAnimation){var p=g.childArmature;p&&p.animation.hasAnimation(e)&&!p.animation.getState(e)&&p.animation.fadeIn(e)}}return this._armature.advanceTime(0),this._lastAnimationState},r.gotoAndPlayByTime=function(t,e,a){return void 0===e&&(e=0),void 0===a&&(a=-1),this._time=e,this.fadeIn(t,0,a,0,null,4)},r.gotoAndPlayByFrame=function(t,e,a){void 0===e&&(e=0),void 0===a&&(a=-1);var i=this._animations[t];return i&&(this._time=i.duration*e/i.frameCount),this.fadeIn(t,0,a,0,null,4)},r.gotoAndPlayByProgress=function(t,e,a){void 0===e&&(e=0),void 0===a&&(a=-1);var i=this._animations[t];return i&&(this._time=i.duration*Math.max(e,0)),this.fadeIn(t,0,a,0,null,4)},r.gotoAndStopByTime=function(t,e){void 0===e&&(e=0);var a=this.gotoAndPlayByTime(t,e,1);return a&&(this._isPlaying=!1,a.stop()),a},r.gotoAndStopByFrame=function(t,e){void 0===e&&(e=0);var a=this.gotoAndPlayByFrame(t,e,1);return a&&(this._isPlaying=!1,a.stop()),a},r.gotoAndStopByProgress=function(t,e){void 0===e&&(e=0);var a=this.gotoAndPlayByProgress(t,e,1);return a&&(this._isPlaying=!1,a.stop()),a},r.getState=function(t){for(var e=0,a=this._animationStates.length;a>e;++e){var i=this._animationStates[e];if(i.name==t)return i}return null},r.hasAnimation=function(t){return null!=this._animations[t]},i(r,"isPlaying",function(){return this._isPlaying}),i(r,"isCompleted",function(){if(this._lastAnimationState){if(!this._lastAnimationState.isCompleted)return!1;for(var t=0,e=this._animationStates.length;e>t;++t)if(!this._animationStates[t].isCompleted)return!1}return!0}),i(r,"lastAnimationName",function(){return this._lastAnimationState?this._lastAnimationState.name:null}),i(r,"lastAnimationState",function(){return this._lastAnimationState}),i(r,"animationNames",function(){return this._animationNames}),i(r,"animations",function(){return this._animations},function(t){if(this._animations!=t){for(var e in this._animations)delete this._animations[e];if(this._animationNames.length=0,t)for(var e in t)this._animations[e]=t[e],this._animationNames.push(e)}}),r.gotoAndPlay=function(t,e,a,i,n,r,s,o,l){void 0===e&&(e=-1),void 0===a&&(a=-1),void 0===i&&(i=-1),void 0===n&&(n=0),void 0===r&&(r=null),void 0===s&&(s=3),void 0===o&&(o=!0),void 0===l&&(l=!0);var h=this.fadeIn(t,e,i,n,r,s,!1,!0,o,l);return h&&a&&a>0&&(h.timeScale=h.totalTime/a),h},r.gotoAndStop=function(t,e){return void 0===e&&(e=0),this.gotoAndStopByTime(t,e)},i(r,"animationList",function(){return this._animationNames}),i(r,"animationDataList",function(){for(var t=[],e=0,a=this._animationNames.length;a>e;++e)t.push(this._animations[this._animationNames[e]]);return t}),a}(t.BaseObject);t.Animation=e,egret.registerClass(e,"dragonBones.Animation")}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(e){function a(){e.call(this),this._boneMask=[],this._boneTimelines=[],this._slotTimelines=[],this._ffdTimelines=[],this.autoTween=!1}__extends(a,e);var i=__define,n=a,r=n.prototype;return a.toString=function(){return"[class dragonBones.AnimationState]"},r._onClear=function(){this.displayControl=!0,this.additiveBlending=!1,this.actionEnabled=!1,this.playTimes=1,this.timeScale=1,this.weight=1,this.autoFadeOutTime=-1,this.fadeTotalTime=0,this._isFadeOutComplete=!1,this._layer=0,this._position=0,this._duration=0,this._weightResult=0,this._fadeProgress=0,this._group=null,this._timeline&&(this._timeline.returnToPool(),this._timeline=null),this._isPlaying=!0,this._isPausePlayhead=!1,this._isFadeOut=!1,this._currentPlayTimes=0,this._fadeTime=0,this._time=0,this._name=null,this._armature=null,this._animationData=null,this._boneMask.length&&(this._boneMask.length=0);for(var t=0,e=this._boneTimelines.length;e>t;++t)this._boneTimelines[t].returnToPool();for(var t=0,e=this._slotTimelines.length;e>t;++t)this._slotTimelines[t].returnToPool();for(var t=0,e=this._ffdTimelines.length;e>t;++t)this._ffdTimelines[t].returnToPool();this._boneTimelines.length=0,this._slotTimelines.length=0,this._ffdTimelines.length=0},r._advanceFadeTime=function(e){var a=this;0>e&&(e=-e),a._fadeTime+=e;var i=0;if(i=a._fadeTime>=a.fadeTotalTime?a._isFadeOut?0:1:a._fadeTime>0?a._isFadeOut?1-a._fadeTime/a.fadeTotalTime:a._fadeTime/a.fadeTotalTime:a._isFadeOut?1:0,a._fadeProgress!=i){a._fadeProgress=i;var n=a._armature._display;if(a._fadeTime<=e)if(a._isFadeOut){if(n.hasEvent(t.EventObject.FADE_OUT)){var r=t.BaseObject.borrowObject(t.EventObject);r.animationState=this,a._armature._bufferEvent(r,t.EventObject.FADE_OUT)}}else if(n.hasEvent(t.EventObject.FADE_IN)){var s=t.BaseObject.borrowObject(t.EventObject);s.animationState=this,a._armature._bufferEvent(s,t.EventObject.FADE_IN)}if(a._fadeTime>=a.fadeTotalTime)if(a._isFadeOut){if(a._isFadeOutComplete=!0,n.hasEvent(t.EventObject.FADE_OUT_COMPLETE)){var o=t.BaseObject.borrowObject(t.EventObject);o.animationState=this,a._armature._bufferEvent(o,t.EventObject.FADE_OUT_COMPLETE)}}else if(a._isPausePlayhead=!1,n.hasEvent(t.EventObject.FADE_IN_COMPLETE)){var l=t.BaseObject.borrowObject(t.EventObject);l.animationState=this,a._armature._bufferEvent(l,t.EventObject.FADE_IN_COMPLETE)}}},r._isDisabled=function(t){return!this.displayControl||t.displayController&&t.displayController!=this._name&&t.displayController!=this._group?!0:!1},r._fadeIn=function(e,i,n,r,s,o,l,h,_,u){this._armature=e,this._animationData=i,this._name=n,this.playTimes=r,this.timeScale=h,this.fadeTotalTime=_,this._position=s,this._duration=o,this._time=l,this._isPausePlayhead=u,0==this.fadeTotalTime&&(this._fadeProgress=.999999),this._timeline=t.BaseObject.borrowObject(t.AnimationTimelineState),this._timeline.fadeIn(this._armature,this,this._animationData,this._time),this._updateTimelineStates(),this.actionEnabled=a.actionEnabled},r._updateTimelineStates=function(){var e=this._time;this._animationData.hasAsynchronyTimeline||(e=this._timeline._currentTime);for(var a={},i={},n=0,r=this._boneTimelines.length;r>n;++n){var s=this._boneTimelines[n];a[s.bone.name]=s}for(var o=this._armature.getBones(),n=0,r=o.length;r>n;++n){var l=o[n],h=l.name,_=this._animationData.getBoneTimeline(h);if(_&&this.containsBoneMask(h)){var s=a[h];s?delete a[h]:(s=t.BaseObject.borrowObject(t.BoneTimelineState),s.bone=l,s.fadeIn(this._armature,this,_,e),this._boneTimelines.push(s))}}for(var n in a){var s=a[n];s.bone.invalidUpdate(),this._boneTimelines.splice(this._boneTimelines.indexOf(s),1),s.returnToPool()}for(var n=0,r=this._slotTimelines.length;r>n;++n){var u=this._slotTimelines[n];i[u.slot.name]=u}for(var m=this._armature.getSlots(),n=0,r=m.length;r>n;++n){var f=m[n],c=f.name,d=f.parent.name,g=this._animationData.getSlotTimeline(c);if(g&&this.containsBoneMask(d)&&!this._isFadeOut){var u=i[c];u?delete i[c]:(u=t.BaseObject.borrowObject(t.SlotTimelineState),u.slot=f,u.fadeIn(this._armature,this,g,e),this._slotTimelines.push(u))}}for(var n in i){var u=i[n];this._slotTimelines.splice(this._slotTimelines.indexOf(u),1),u.returnToPool()}this._updateFFDTimelineStates()},r._updateFFDTimelineStates=function(){var e=this._time;this._animationData.hasAsynchronyTimeline||(e=this._timeline._currentTime);for(var a={},i=0,n=this._ffdTimelines.length;n>i;++i){var r=this._ffdTimelines[i];a[r.slot.name]=r}for(var s=this._armature.getSlots(),i=0,n=s.length;n>i;++i){var o=s[i],l=o.name,h=o.parent.name;if(o._meshData){var _=this._animationData.getFFDTimeline(this._armature._skinData.name,l,o.displayIndex);if(_&&this.containsBoneMask(h)){var r=a[l];r?delete a[l]:(r=t.BaseObject.borrowObject(t.FFDTimelineState),r.slot=o,r.fadeIn(this._armature,this,_,e),this._ffdTimelines.push(r))}else{for(var u=0,m=o._ffdVertices.length;m>u;++u)o._ffdVertices[u]=0;o._ffdDirty=!0}}}for(var i in a){var r=a[i];r.slot._ffdDirty=!0,this._ffdTimelines.splice(this._ffdTimelines.indexOf(r),1),r.returnToPool()}},r._advanceTime=function(t,e,a){var i=this;if(0!=t&&i._advanceFadeTime(t),t*=i.timeScale,0!=t&&i._isPlaying&&!i._isPausePlayhead&&(i._time+=t),i._weightResult=i.weight*i._fadeProgress*e,0!=i._weightResult){var n=i._fadeProgress>=1&&0==a&&i._armature.cacheFrameRate>0,r=i._animationData.cacheTimeToFrameScale,s=!0,o=!0,l=2*r;if(l=n?Math.floor(i._time*l)/l:i._time,i._timeline.update(l),i._animationData.hasAsynchronyTimeline||(l=i._timeline._currentTime),n){var h=Math.floor(i._timeline._currentTime*r);if(i._armature._cacheFrameIndex==h)s=!1,o=!1;else{if(i._armature._cacheFrameIndex=h,i._armature._animation._animationStateDirty){i._armature._animation._animationStateDirty=!1;for(var _=0,u=i._boneTimelines.length;u>_;++_){var m=i._boneTimelines[_];m.bone._cacheFrames=m._timeline.cachedFrames}for(var _=0,u=i._slotTimelines.length;u>_;++_){var f=i._slotTimelines[_];f.slot._cacheFrames=f._timeline.cachedFrames}}i._animationData.cachedFrames[h]?o=!1:i._animationData.cachedFrames[h]=!0}}else i._armature._cacheFrameIndex=-1;if(s){if(o)for(var _=0,u=i._boneTimelines.length;u>_;++_)i._boneTimelines[_].update(l);for(var _=0,u=i._slotTimelines.length;u>_;++_)i._slotTimelines[_].update(l);for(var _=0,u=i._ffdTimelines.length;u>_;++_)i._ffdTimelines[_].update(l)}}i.autoFadeOutTime>=0&&i._fadeProgress>=1&&i._timeline._isCompleted&&i.fadeOut(i.autoFadeOutTime)},r.play=function(){this._isPlaying=!0},r.stop=function(){this._isPlaying=!1},r.fadeOut=function(t,e){if(void 0===e&&(e=!0),(0>t||t!=t)&&(t=0),this._isPausePlayhead=e,this._isFadeOut){if(t>t-this._fadeTime)return}else{this._isFadeOut=!0,(0==t||this._fadeProgress<=0)&&(this._fadeProgress=1e-6);for(var a=0,i=this._boneTimelines.length;i>a;++a)this._boneTimelines[a].fadeOut();for(var a=0,i=this._slotTimelines.length;i>a;++a)this._slotTimelines[a].fadeOut()}this.displayControl=!1,this.fadeTotalTime=this._fadeProgress>1e-6?t/this._fadeProgress:0,this._fadeTime=this.fadeTotalTime*(1-this._fadeProgress)},r.containsBoneMask=function(t){return!this._boneMask.length||this._boneMask.indexOf(t)>=0},r.addBoneMask=function(t,e){void 0===e&&(e=!0);var a=this._armature.getBone(t);if(a){if(this._boneMask.indexOf(t)<0&&this._animationData.getBoneTimeline(t)&&this._boneMask.push(t),e)for(var i=this._armature.getBones(),n=0,r=i.length;r>n;++n){var s=i[n],o=s.name;this._boneMask.indexOf(o)<0&&this._animationData.getBoneTimeline(o)&&a.contains(s)&&this._boneMask.push(o)}this._updateTimelineStates()}},r.removeBoneMask=function(t,e){void 0===e&&(e=!0);var a=this._boneMask.indexOf(t);if(a>=0&&this._boneMask.splice(a,1),e){var i=this._armature.getBone(t);if(i)for(var n=this._armature.getBones(),r=0,s=n.length;s>r;++r){var o=n[r],l=o.name,h=this._boneMask.indexOf(l);h>=0&&i.contains(o)&&this._boneMask.splice(h,1)}}this._updateTimelineStates()},r.removeAllBoneMask=function(){this._boneMask.length=0,this._updateTimelineStates()},i(r,"layer",function(){return this._layer}),i(r,"group",function(){return this._group}),i(r,"name",function(){return this._name}),i(r,"animationData",function(){return this._animationData}),i(r,"isCompleted",function(){return this._timeline._isCompleted}),i(r,"isPlaying",function(){return this._isPlaying&&!this._timeline._isCompleted}),i(r,"currentPlayTimes",function(){return this._currentPlayTimes}),i(r,"totalTime",function(){return this._duration}),i(r,"currentTime",function(){return this._timeline._currentTime},function(t){if((0>t||t!=t)&&(t=0),this._time=t,this._timeline.setCurrentTime(this._time),0!=this._weightResult){var e=this._time;this._animationData.hasAsynchronyTimeline||(e=this._timeline._currentTime);for(var a=0,i=this._boneTimelines.length;i>a;++a)this._boneTimelines[a].setCurrentTime(e);for(var a=0,i=this._slotTimelines.length;i>a;++a)this._slotTimelines[a].setCurrentTime(e);for(var a=0,i=this._ffdTimelines.length;i>a;++a)this._ffdTimelines[a].setCurrentTime(e)}}),i(r,"clip",function(){return this._animationData}),a.actionEnabled=!0,a}(t.BaseObject);t.AnimationState=e,egret.registerClass(e,"dragonBones.AnimationState")}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(t){function e(){t.call(this)}__extends(e,t);var a=(__define,e),i=a.prototype;return i._onClear=function(){this._isCompleted=!1,this._currentPlayTimes=0,this._currentTime=0,this._timeline=null,this._isReverse=!1,this._hasAsynchronyTimeline=!1,this._frameRate=0,this._keyFrameCount=0,this._frameCount=0,this._position=0,this._duration=0,this._animationDutation=0,this._timeScale=1,this._timeOffset=0,this._currentFrame=null,this._armature=null,this._animationState=null},i._onFadeIn=function(){},i._onUpdateFrame=function(t){},i._onArriveAtFrame=function(t){},i._setCurrentTime=function(t){var e=this,a=0;if(e._hasAsynchronyTimeline){var i=e._animationState.playTimes,n=i*e._duration;t*=e._timeScale,0!=e._timeOffset&&(t+=e._timeOffset*e._animationDutation),i>0&&(t>=n||-n>=t)?(e._isCompleted=!0,a=i,t=0>t?0:e._duration):(e._isCompleted=!1,0>t?(a=Math.floor(-t/e._duration),t=e._duration- -t%e._duration):(a=Math.floor(t/e._duration),t%=e._duration),i>0&&a>i&&(a=i)),t+=e._position}else e._isCompleted=e._animationState._timeline._isCompleted,a=e._animationState._timeline._currentPlayTimes;return e._currentTime==t?!1:(1==e._keyFrameCount&&t>e._position&&this!=e._animationState._timeline&&(e._isCompleted=!0),e._isReverse=e._currentTime>t&&e._currentPlayTimes==a,e._currentTime=t,e._currentPlayTimes=a,!0)},i.setCurrentTime=function(t){switch(this._setCurrentTime(t),this._keyFrameCount){case 0:break;case 1:this._currentFrame=this._timeline.frames[0],this._onArriveAtFrame(!1),this._onUpdateFrame(!1);break;default:this._currentFrame=this._timeline.frames[Math.floor(this._currentTime*this._frameRate)],this._onArriveAtFrame(!1),this._onUpdateFrame(!1)}this._currentFrame=null},i.fadeIn=function(t,e,a,i){this._armature=t,this._animationState=e,this._timeline=a;var n=this==this._animationState._timeline;this._hasAsynchronyTimeline=n||this._animationState.animationData.hasAsynchronyTimeline,this._frameRate=this._armature.armatureData.frameRate,this._keyFrameCount=this._timeline.frames.length,this._frameCount=this._animationState.animationData.frameCount,this._position=this._animationState._position,this._duration=this._animationState._duration,this._animationDutation=this._animationState.animationData.duration,this._timeScale=n?1:1/this._timeline.scale,this._timeOffset=n?0:this._timeline.offset,this._onFadeIn(),this.setCurrentTime(i)},i.fadeOut=function(){},i.update=function(t){var e=this;if(!e._isCompleted&&e._setCurrentTime(t)&&e._keyFrameCount){var a=e._keyFrameCount>1?Math.floor(e._currentTime*e._frameRate):0,i=e._timeline.frames[a];e._currentFrame!=i&&(e._currentFrame=i,e._onArriveAtFrame(!0)),e._onUpdateFrame(!0)}},e}(t.BaseObject);t.TimelineState=e,egret.registerClass(e,"dragonBones.TimelineState");var a=function(e){function a(){e.call(this)}__extends(a,e);var i=(__define,a),n=i.prototype;return a._getEasingValue=function(t,e){var a=1;if(e>2)return t;if(e>1)a=.5*(1-Math.cos(t*Math.PI)),e-=1;else if(e>0)a=1-Math.pow(1-t,2);else if(e>=-1)e*=-1,a=Math.pow(t,2);else{if(!(e>=-2))return t;e*=-1,a=Math.acos(1-2*t)/Math.PI,e-=1}return(a-t)*e+t},a._getCurveEasingValue=function(t,e){if(0>=t)return 0;if(t>=1)return 1;for(var a=0,i=0,n=0,r=e.length;r>n;n+=2)if(a=e[n],i=e[n+1],a>=t){if(0==n)return i*t/a;var s=e[n-2],o=e[n-1];return o+(i-o)*(t-s)/(a-s)}return i+(1-i)*(t-a)/(1-a)},n._onClear=function(){e.prototype._onClear.call(this),this._tweenProgress=0,this._tweenEasing=t.DragonBones.NO_TWEEN,this._curve=null},n._onArriveAtFrame=function(e){var a=this;a._tweenEasing=a._currentFrame.tweenEasing,a._curve=a._currentFrame.curve,(a._keyFrameCount<=1||a._currentFrame.next==a._timeline.frames[0]&&(a._tweenEasing!=t.DragonBones.NO_TWEEN||a._curve)&&a._animationState.playTimes>0&&a._animationState.currentPlayTimes==a._animationState.playTimes-1)&&(a._tweenEasing=t.DragonBones.NO_TWEEN,a._curve=null)},n._onUpdateFrame=function(e){var i=this;i._tweenEasing!=t.DragonBones.NO_TWEEN?(i._tweenProgress=(i._currentTime-i._currentFrame.position+i._position)/i._currentFrame.duration,0!=i._tweenEasing&&(i._tweenProgress=a._getEasingValue(i._tweenProgress,i._tweenEasing))):i._curve?(i._tweenProgress=(i._currentTime-i._currentFrame.position+i._position)/i._currentFrame.duration,i._tweenProgress=a._getCurveEasingValue(i._tweenProgress,i._curve)):i._tweenProgress=0},n._updateExtensionKeyFrame=function(t,e,a){var i=0;if(t.type==e.type)for(var n=0,r=t.tweens.length;r>n;++n){var s=e.tweens[n]-t.tweens[n];a.tweens[n]=s,0!=s&&(i=2)}if(0==i){a.type!=t.type&&(i=1,a.type=t.type),a.tweens.length!=t.tweens.length&&(i=1,a.tweens.length=t.tweens.length),a.keys.length!=t.keys.length&&(i=1,a.keys.length=t.keys.length);for(var n=0,r=t.keys.length;r>n;++n){var o=t.keys[n];a.keys[n]!=o&&(i=1,a.keys[n]=o)}}return i},a}(e);t.TweenTimelineState=a,egret.registerClass(a,"dragonBones.TweenTimelineState")}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(e){function a(){e.call(this)}__extends(a,e);var i=(__define,a),n=i.prototype;return a.toString=function(){return"[class dragonBones.AnimationTimelineState]"},n._onClear=function(){e.prototype._onClear.call(this),this._isStarted=!1},n._onCrossFrame=function(e){var a=this;if(this._animationState.actionEnabled)for(var i=e.actions,n=0,r=i.length;r>n;++n)a._armature._bufferAction(i[n]);for(var s=a._armature._display,o=e.events,n=0,r=o.length;r>n;++n){var l=o[n],h="";switch(l.type){case 10:h=t.EventObject.FRAME_EVENT;break;case 11:h=t.EventObject.SOUND_EVENT}if((11==l.type?t.EventObject._soundEventManager||s:s).hasEvent(h)){var _=t.BaseObject.borrowObject(t.EventObject);_.animationState=a._animationState,_.frame=e,l.bone&&(_.bone=a._armature.getBone(l.bone.name)),l.slot&&(_.slot=a._armature.getSlot(l.slot.name)),_.name=l.name,_.data=l.data,a._armature._bufferEvent(_,h)}}},n.update=function(e){var a=this,i=a._currentTime,n=a._currentPlayTimes;if(!a._isCompleted&&a._setCurrentTime(e)){var r=a._armature._display;if(!a._isStarted&&0!=e&&(a._isStarted=!0,r.hasEvent(t.EventObject.START))){var s=t.BaseObject.borrowObject(t.EventObject);s.animationState=a._animationState,a._armature._bufferEvent(s,t.EventObject.START)}if(a._keyFrameCount){var o=a._keyFrameCount>1?Math.floor(a._currentTime*a._frameRate):0,l=a._timeline.frames[o];if(a._currentFrame!=l)if(a._keyFrameCount>1){var h=a._currentFrame;if(a._currentFrame=l,!h){var _=Math.floor(i*a._frameRate);h=a._timeline.frames[_],a._isReverse||(i<=h.position||n!=a._currentPlayTimes)&&(h=h.prev)}if(a._isReverse)for(;h!=l;)a._onCrossFrame(h),h=h.prev;else for(;h!=l;)h=h.next,a._onCrossFrame(h)}else a._currentFrame=l,a._onCrossFrame(a._currentFrame)}if(n!=a._currentPlayTimes){var u=a._isCompleted?t.EventObject.COMPLETE:t.EventObject.LOOP_COMPLETE;if(r.hasEvent(u)){var s=t.BaseObject.borrowObject(t.EventObject);s.animationState=a._animationState,a._armature._bufferEvent(s,u)}a._currentFrame=null}}},a}(t.TimelineState);t.AnimationTimelineState=e,egret.registerClass(e,"dragonBones.AnimationTimelineState");var a=function(e){function a(){e.call(this),this._transform=new t.Transform,this._currentTransform=new t.Transform,this._durationTransform=new t.Transform}__extends(a,e);var i=(__define,a),n=i.prototype;return a.toString=function(){return"[class dragonBones.BoneTimelineState]"},n._onClear=function(){e.prototype._onClear.call(this),this.bone=null,this._tweenTransform=0,this._tweenRotate=0,this._tweenScale=0,this._boneTransform=null,this._originTransform=null,this._transform.identity(),this._currentTransform.identity(),this._durationTransform.identity()},n._onFadeIn=function(){this._originTransform=this._timeline.originTransform,this._boneTransform=this.bone._animationPose},n._onArriveAtFrame=function(a){var i=this;if(e.prototype._onArriveAtFrame.call(this,a),i._currentTransform.copyFrom(i._currentFrame.transform),i._tweenTransform=1,i._tweenRotate=1,i._tweenScale=1,i._keyFrameCount>1&&(i._tweenEasing!=t.DragonBones.NO_TWEEN||i._curve)){var n=i._currentFrame.next,r=n.transform;i._durationTransform.x=r.x-i._currentTransform.x,i._durationTransform.y=r.y-i._currentTransform.y,(0!=i._durationTransform.x||0!=i._durationTransform.y)&&(i._tweenTransform=2);var s=i._currentFrame.tweenRotate;if(s==s){if(s)if(s>0?r.skewY>=i._currentTransform.skewY:r.skewY<=i._currentTransform.skewY){var o=s>0?s-1:s+1;i._durationTransform.skewX=r.skewX-i._currentTransform.skewX+t.DragonBones.PI_D*o,i._durationTransform.skewY=r.skewY-i._currentTransform.skewY+t.DragonBones.PI_D*o}else i._durationTransform.skewX=r.skewX-i._currentTransform.skewX+t.DragonBones.PI_D*s,i._durationTransform.skewY=r.skewY-i._currentTransform.skewY+t.DragonBones.PI_D*s;else i._durationTransform.skewX=t.Transform.normalizeRadian(r.skewX-i._currentTransform.skewX),i._durationTransform.skewY=t.Transform.normalizeRadian(r.skewY-i._currentTransform.skewY);(0!=i._durationTransform.skewX||0!=i._durationTransform.skewY)&&(i._tweenRotate=2)}else i._durationTransform.skewX=0,i._durationTransform.skewY=0;i._currentFrame.tweenScale?(i._durationTransform.scaleX=r.scaleX-i._currentTransform.scaleX,i._durationTransform.scaleY=r.scaleY-i._currentTransform.scaleY,(0!=i._durationTransform.scaleX||0!=i._durationTransform.scaleY)&&(i._tweenScale=2)):(i._durationTransform.scaleX=0,i._durationTransform.scaleY=0)}else i._durationTransform.x=0,i._durationTransform.y=0,i._durationTransform.skewX=0,i._durationTransform.skewY=0,i._durationTransform.scaleX=0,i._durationTransform.scaleY=0},n._onUpdateFrame=function(t){var a=this;if(a._tweenTransform||a._tweenRotate||a._tweenScale){e.prototype._onUpdateFrame.call(this,t);var i=0;a._tweenTransform&&(1==a._tweenTransform?(a._tweenTransform=0,i=0):i=a._tweenProgress,a._animationState.additiveBlending?(a._transform.x=a._currentTransform.x+a._durationTransform.x*i,a._transform.y=a._currentTransform.y+a._durationTransform.y*i):(a._transform.x=a._originTransform.x+a._currentTransform.x+a._durationTransform.x*i,a._transform.y=a._originTransform.y+a._currentTransform.y+a._durationTransform.y*i)),a._tweenRotate&&(1==a._tweenRotate?(a._tweenRotate=0,i=0):i=a._tweenProgress,a._animationState.additiveBlending?(a._transform.skewX=a._currentTransform.skewX+a._durationTransform.skewX*i,a._transform.skewY=a._currentTransform.skewY+a._durationTransform.skewY*i):(a._transform.skewX=a._originTransform.skewX+a._currentTransform.skewX+a._durationTransform.skewX*i,a._transform.skewY=a._originTransform.skewY+a._currentTransform.skewY+a._durationTransform.skewY*i)),a._tweenScale&&(1==a._tweenScale?(a._tweenScale=0,i=0):i=a._tweenProgress,a._animationState.additiveBlending?(a._transform.scaleX=a._currentTransform.scaleX+a._durationTransform.scaleX*i,a._transform.scaleY=a._currentTransform.scaleY+a._durationTransform.scaleY*i):(a._transform.scaleX=a._originTransform.scaleX*(a._currentTransform.scaleX+a._durationTransform.scaleX*i),a._transform.scaleY=a._originTransform.scaleY*(a._currentTransform.scaleY+a._durationTransform.scaleY*i))),a.bone.invalidUpdate()}},n.fadeOut=function(){this._transform.skewX=t.Transform.normalizeRadian(this._transform.skewX),this._transform.skewY=t.Transform.normalizeRadian(this._transform.skewY)},n.update=function(t){var a=this;e.prototype.update.call(this,t);var i=a._animationState._weightResult;if(i>0){0==a.bone._blendIndex?(a._boneTransform.x=a._transform.x*i,a._boneTransform.y=a._transform.y*i,a._boneTransform.skewX=a._transform.skewX*i,a._boneTransform.skewY=a._transform.skewY*i,a._boneTransform.scaleX=(a._transform.scaleX-1)*i+1,a._boneTransform.scaleY=(a._transform.scaleY-1)*i+1):(a._boneTransform.x+=a._transform.x*i,a._boneTransform.y+=a._transform.y*i,a._boneTransform.skewX+=a._transform.skewX*i,a._boneTransform.skewY+=a._transform.skewY*i,a._boneTransform.scaleX+=(a._transform.scaleX-1)*i,a._boneTransform.scaleY+=(a._transform.scaleY-1)*i),a.bone._blendIndex++;var n=a._animationState._fadeProgress;1>n&&a.bone.invalidUpdate()}},a}(t.TweenTimelineState);t.BoneTimelineState=a,egret.registerClass(a,"dragonBones.BoneTimelineState");var i=function(e){function a(){e.call(this),this._color=new t.ColorTransform,this._durationColor=new t.ColorTransform}__extends(a,e);var i=(__define,a),n=i.prototype;return a.toString=function(){return"[class dragonBones.SlotTimelineState]"},n._onClear=function(){e.prototype._onClear.call(this),this.slot=null,this._colorDirty=!1,this._tweenColor=0,this._slotColor=null,this._color.identity(),this._durationColor.identity()},n._onFadeIn=function(){this._slotColor=this.slot._colorTransform},n._onArriveAtFrame=function(a){var i=this;if(e.prototype._onArriveAtFrame.call(this,a),i._animationState._isDisabled(i.slot))return i._tweenEasing=t.DragonBones.NO_TWEEN,i._curve=null,void(i._tweenColor=0);if(i.slot._displayDataSet){var n=i._currentFrame.displayIndex;i.slot.displayIndex>=0&&n>=0?i.slot._displayDataSet.displays.length>1&&i.slot._setDisplayIndex(n):i.slot._setDisplayIndex(n),i.slot._updateMeshData(!0)}if(i._currentFrame.displayIndex>=0){i._tweenColor=0;var r=i._currentFrame.color;if(i._keyFrameCount>1&&(i._tweenEasing!=t.DragonBones.NO_TWEEN||i._curve)){var s=i._currentFrame.next,o=s.color;r!=o&&s.displayIndex>=0&&(i._durationColor.alphaMultiplier=o.alphaMultiplier-r.alphaMultiplier,i._durationColor.redMultiplier=o.redMultiplier-r.redMultiplier,i._durationColor.greenMultiplier=o.greenMultiplier-r.greenMultiplier,i._durationColor.blueMultiplier=o.blueMultiplier-r.blueMultiplier,i._durationColor.alphaOffset=o.alphaOffset-r.alphaOffset,i._durationColor.redOffset=o.redOffset-r.redOffset,i._durationColor.greenOffset=o.greenOffset-r.greenOffset,i._durationColor.blueOffset=o.blueOffset-r.blueOffset,(0!=i._durationColor.alphaMultiplier||0!=i._durationColor.redMultiplier||0!=i._durationColor.greenMultiplier||0!=i._durationColor.blueMultiplier||0!=i._durationColor.alphaOffset||0!=i._durationColor.redOffset||0!=i._durationColor.greenOffset||0!=i._durationColor.blueOffset)&&(i._tweenColor=2))}0==i._tweenColor&&(i._slotColor.alphaMultiplier!=r.alphaMultiplier||i._slotColor.redMultiplier!=r.redMultiplier||i._slotColor.greenMultiplier!=r.greenMultiplier||i._slotColor.blueMultiplier!=r.blueMultiplier||i._slotColor.alphaOffset!=r.alphaOffset||i._slotColor.redOffset!=r.redOffset||i._slotColor.greenOffset!=r.greenOffset||i._slotColor.blueOffset!=r.blueOffset)&&(i._tweenColor=1)}else i._tweenEasing=t.DragonBones.NO_TWEEN,i._curve=null,i._tweenColor=0},n._onUpdateFrame=function(t){var a=this;e.prototype._onUpdateFrame.call(this,t);var i=0;if(a._tweenColor){1==a._tweenColor?(a._tweenColor=0,i=0):i=a._tweenProgress;var n=a._currentFrame.color;a._color.alphaMultiplier=n.alphaMultiplier+a._durationColor.alphaMultiplier*i,a._color.redMultiplier=n.redMultiplier+a._durationColor.redMultiplier*i,a._color.greenMultiplier=n.greenMultiplier+a._durationColor.greenMultiplier*i,a._color.blueMultiplier=n.blueMultiplier+a._durationColor.blueMultiplier*i,a._color.alphaOffset=n.alphaOffset+a._durationColor.alphaOffset*i,a._color.redOffset=n.redOffset+a._durationColor.redOffset*i,a._color.greenOffset=n.greenOffset+a._durationColor.greenOffset*i,a._color.blueOffset=n.blueOffset+a._durationColor.blueOffset*i,a._colorDirty=!0
}},n.fadeOut=function(){this._tweenColor=0},n.update=function(t){var a=this;if(e.prototype.update.call(this,t),0!=a._tweenColor||a._colorDirty){var i=a._animationState._weightResult;if(i>0){var n=a._animationState._fadeProgress;1>n?(a._slotColor.alphaMultiplier+=(a._color.alphaMultiplier-a._slotColor.alphaMultiplier)*n,a._slotColor.redMultiplier+=(a._color.redMultiplier-a._slotColor.redMultiplier)*n,a._slotColor.greenMultiplier+=(a._color.greenMultiplier-a._slotColor.greenMultiplier)*n,a._slotColor.blueMultiplier+=(a._color.blueMultiplier-a._slotColor.blueMultiplier)*n,a._slotColor.alphaOffset+=(a._color.alphaOffset-a._slotColor.alphaOffset)*n,a._slotColor.redOffset+=(a._color.redOffset-a._slotColor.redOffset)*n,a._slotColor.greenOffset+=(a._color.greenOffset-a._slotColor.greenOffset)*n,a._slotColor.blueOffset+=(a._color.blueOffset-a._slotColor.blueOffset)*n,a.slot._colorDirty=!0):a._colorDirty&&(a._colorDirty=!1,a._slotColor.alphaMultiplier=a._color.alphaMultiplier,a._slotColor.redMultiplier=a._color.redMultiplier,a._slotColor.greenMultiplier=a._color.greenMultiplier,a._slotColor.blueMultiplier=a._color.blueMultiplier,a._slotColor.alphaOffset=a._color.alphaOffset,a._slotColor.redOffset=a._color.redOffset,a._slotColor.greenOffset=a._color.greenOffset,a._slotColor.blueOffset=a._color.blueOffset,a.slot._colorDirty=!0)}}},a}(t.TweenTimelineState);t.SlotTimelineState=i,egret.registerClass(i,"dragonBones.SlotTimelineState");var n=function(e){function a(){e.call(this),this._ffdVertices=[]}__extends(a,e);var i=(__define,a),n=i.prototype;return a.toString=function(){return"[class dragonBones.FFDTimelineState]"},n._onClear=function(){e.prototype._onClear.call(this),this.slot=null,this._tweenFFD=0,this._slotFFDVertices=null,this._durationFFDFrame&&(this._durationFFDFrame.returnToPool(),this._durationFFDFrame=null),this._ffdVertices.length&&(this._ffdVertices.length=0)},n._onFadeIn=function(){this._slotFFDVertices=this.slot._ffdVertices,this._durationFFDFrame=t.BaseObject.borrowObject(t.ExtensionFrameData),this._durationFFDFrame.tweens.length=this._slotFFDVertices.length,this._ffdVertices.length=this._slotFFDVertices.length;for(var e=0,a=this._durationFFDFrame.tweens.length;a>e;++e)this._durationFFDFrame.tweens[e]=0;for(var e=0,a=this._ffdVertices.length;a>e;++e)this._ffdVertices[e]=0},n._onArriveAtFrame=function(a){var i=this;if(e.prototype._onArriveAtFrame.call(this,a),i._tweenFFD=0,(i._tweenEasing!=t.DragonBones.NO_TWEEN||i._curve)&&(i._tweenFFD=i._updateExtensionKeyFrame(i._currentFrame,i._currentFrame.next,i._durationFFDFrame)),0==i._tweenFFD)for(var n=i._currentFrame.tweens,r=0,s=n.length;s>r;++r)if(i._slotFFDVertices[r]!=n[r]){i._tweenFFD=1;break}},n._onUpdateFrame=function(t){var a=this;e.prototype._onUpdateFrame.call(this,t);var i=0;if(0!=a._tweenFFD){1==a._tweenFFD?(a._tweenFFD=0,i=0):i=a._tweenProgress;for(var n=a._currentFrame.tweens,r=a._durationFFDFrame.tweens,s=0,o=n.length;o>s;++s)a._ffdVertices[s]=n[s]+r[s]*i;a.slot._ffdDirty=!0}},n.update=function(t){var a=this;e.prototype.update.call(this,t);var i=a._animationState._weightResult;if(i>0){if(0==a.slot._blendIndex)for(var n=0,r=a._ffdVertices.length;r>n;++n)a._slotFFDVertices[n]=a._ffdVertices[n]*i;else for(var n=0,r=a._ffdVertices.length;r>n;++n)a._slotFFDVertices[n]+=a._ffdVertices[n]*i;a.slot._blendIndex++;var s=a._animationState._fadeProgress;1>s&&(a.slot._ffdDirty=!0)}},a}(t.TweenTimelineState);t.FFDTimelineState=n,egret.registerClass(n,"dragonBones.FFDTimelineState")}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(){function e(){this.time=(new Date).getTime()/t.DragonBones.SECOND_TO_MILLISECOND,this.timeScale=1,this._animatebles=[]}var a=__define,i=e,n=i.prototype;return a(e,"clock",function(){return e._clock||(e._clock=new e),e._clock}),n.advanceTime=function(e){if(e!=e&&(e=0),0>e&&(e=(new Date).getTime()/t.DragonBones.SECOND_TO_MILLISECOND-this.time),e*=this.timeScale,0>e?this.time-=e:this.time+=e,e){for(var a=0,i=0,n=this._animatebles.length;n>a;++a){var r=this._animatebles[a];r?(i>0&&(this._animatebles[a-i]=r,this._animatebles[a]=null),r.advanceTime(e)):i++}if(i>0){for(n=this._animatebles.length;n>a;++a){var r=this._animatebles[a];r?this._animatebles[a-i]=r:i++}this._animatebles.length-=i}}},n.contains=function(t){return this._animatebles.indexOf(t)>=0},n.add=function(e){e&&this._animatebles.indexOf(e)<0&&(this._animatebles.push(e),t.DragonBones.debug&&e instanceof t.Armature&&t.DragonBones.addArmature(e))},n.remove=function(e){var a=this._animatebles.indexOf(e);a>=0&&(this._animatebles[a]=null,t.DragonBones.debug&&e instanceof t.Armature&&t.DragonBones.removeArmature(e))},n.clear=function(){for(var t=0,e=this._animatebles.length;e>t;++t)this._animatebles[t]=null},e._clock=null,e}();t.WorldClock=e,egret.registerClass(e,"dragonBones.WorldClock",["dragonBones.IAnimateble"])}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(e){function a(){e.call(this),this._bones=[],this._slots=[],this._actions=[],this._events=[],this.enableCache=!1}__extends(a,e);var i=__define,n=a,r=n.prototype;return a.toString=function(){return"[class dragonBones.Armature]"},r._onClear=function(){if(this.userData=null,this._bonesDirty=!1,this._cacheFrameIndex=-1,this._armatureData=null,this._skinData=null,this._animation&&(this._animation.returnToPool(),this._animation=null),this._display&&(this._display._onClear(),this._display=null),this._parent=null,this._replacedTexture=null,this._delayDispose=!1,this._lockDispose=!1,this._slotsDirty=!1,this._bones.length){for(var t=0,e=this._bones.length;e>t;++t)this._bones[t].returnToPool();this._bones.length=0}if(this._slots.length){for(var t=0,e=this._slots.length;e>t;++t)this._slots[t].returnToPool();this._slots.length=0}if(this._actions.length){for(var t=0,e=this._actions.length;e>t;++t)this._actions[t].returnToPool();this._actions.length=0}if(this._events.length){for(var t=0,e=this._events.length;e>t;++t)this._events[t].returnToPool();this._events.length=0}},r._sortBones=function(){var t=this._bones.length;if(t){var e=this._bones.concat(),a=0,i=0;for(this._bones.length=0;t>i;){var n=e[a++];a>=t&&(a=0),this._bones.indexOf(n)>=0||n.parent&&this._bones.indexOf(n.parent)<0||n.ik&&this._bones.indexOf(n.ik)<0||(n.ik&&n.ikChain>0&&n.ikChainIndex==n.ikChain?this._bones.splice(this._bones.indexOf(n.parent)+1,0,n):this._bones.push(n),i++)}}},r._sortSlots=function(){},r._doAction=function(t){switch(t.type){case 0:this._animation.play(t.data[0],t.data[1]);break;case 1:this._animation.stop(t.data[0]);break;case 2:this._animation.gotoAndPlayByTime(t.data[0],t.data[1],t.data[2]);break;case 3:this._animation.gotoAndStopByTime(t.data[0],t.data[1]);break;case 4:this._animation.fadeIn(t.data[0],t.data[1],t.data[2]);break;case 5:}},r._addBoneToBoneList=function(t){this._bones.indexOf(t)<0&&(this._bonesDirty=!0,this._bones[this._bones.length]=t,this._animation._timelineStateDirty=!0)},r._removeBoneFromBoneList=function(t){var e=this._bones.indexOf(t);e>=0&&(this._bones.splice(e,1),this._animation._timelineStateDirty=!0)},r._addSlotToSlotList=function(t){this._slots.indexOf(t)<0&&(this._slotsDirty=!0,this._slots[this._slots.length]=t,this._animation._timelineStateDirty=!0)},r._removeSlotFromSlotList=function(t){var e=this._slots.indexOf(t);e>=0&&(this._slots.splice(e,1),this._animation._timelineStateDirty=!0)},r._bufferAction=function(t){this._actions.push(t)},r._bufferEvent=function(t,e){t.type=e,t.armature=this,this._events.push(t)},r.dispose=function(){this._delayDispose=!0,this._lockDispose||this.returnToPool()},r.advanceTime=function(e){var a=this;if(!a._lockDispose){a._lockDispose=!0;var i=e*a._animation.timeScale;a._animation._advanceTime(i),a._bonesDirty&&(a._bonesDirty=!1,a._sortBones()),a._slotsDirty&&(a._slotsDirty=!1,a._sortSlots());for(var n=0,r=a._bones.length;r>n;++n)a._bones[n]._update(a._cacheFrameIndex);for(var n=0,r=a._slots.length;r>n;++n){var s=a._slots[n];s._update(a._cacheFrameIndex);var o=s._childArmature;o&&(s.inheritAnimation?o.advanceTime(i):o.advanceTime(e))}if(t.DragonBones.debugDraw&&a._display._debugDraw(),a._events.length>0){for(var n=0,r=a._events.length;r>n;++n){var l=a._events[n];t.EventObject._soundEventManager&&l.type==t.EventObject.SOUND_EVENT?t.EventObject._soundEventManager._dispatchEvent(l):a._display._dispatchEvent(l),l.returnToPool()}a._events.length=0}if(a._actions.length>0){for(var n=0,r=a._actions.length;r>n;++n){var h=a._actions[n];if(h.slot){var s=a.getSlot(h.slot.name);if(s){var o=s._childArmature;o&&o._doAction(h)}}else if(h.bone)for(var _=0,u=a._slots.length;u>_;++_){var o=a._slots[_]._childArmature;o&&o._doAction(h)}else this._doAction(h)}a._actions.length=0}a._lockDispose=!1}a._delayDispose&&a.returnToPool()},r.invalidUpdate=function(t,e){if(void 0===t&&(t=null),void 0===e&&(e=!1),t){var a=this.getBone(t);if(a&&(a.invalidUpdate(),e))for(var i=0,n=this._slots.length;n>i;++i){var r=this._slots[i];r.parent==a&&r.invalidUpdate()}}else{for(var i=0,n=this._bones.length;n>i;++i)this._bones[i].invalidUpdate();if(e)for(var i=0,n=this._slots.length;n>i;++i)this._slots[i].invalidUpdate()}},r.getSlot=function(t){for(var e=0,a=this._slots.length;a>e;++e){var i=this._slots[e];if(i.name==t)return i}return null},r.getSlotByDisplay=function(t){if(t)for(var e=0,a=this._slots.length;a>e;++e){var i=this._slots[e];if(i.display==t)return i}return null},r.addSlot=function(t,e){var a=this.getBone(e);if(!a)throw new Error;t._setArmature(this),t._setParent(a)},r.removeSlot=function(t){if(!t||t.armature!=this)throw new Error;t._setParent(null),t._setArmature(null)},r.getBone=function(t){for(var e=0,a=this._bones.length;a>e;++e){var i=this._bones[e];if(i.name==t)return i}return null},r.getBoneByDisplay=function(t){var e=this.getSlotByDisplay(t);return e?e.parent:null},r.addBone=function(t,e){if(void 0===e&&(e=null),!t)throw new Error;t._setArmature(this),t._setParent(e?this.getBone(e):null)},r.removeBone=function(t){if(!t||t.armature!=this)throw new Error;t._setParent(null),t._setArmature(null)},r.replaceTexture=function(t){this._replacedTexture=t;for(var e=0,a=this._slots.length;a>e;++e)this._slots[e].invalidUpdate()},r.getBones=function(){return this._bones},r.getSlots=function(){return this._slots},i(r,"name",function(){return this._armatureData?this._armatureData.name:null}),i(r,"armatureData",function(){return this._armatureData}),i(r,"animation",function(){return this._animation}),i(r,"display",function(){return this._display}),i(r,"parent",function(){return this._parent}),i(r,"cacheFrameRate",function(){return this._armatureData.cacheFrameRate},function(t){if(this._armatureData.cacheFrameRate!=t){this._armatureData.cacheFrames(t);for(var e=0,a=this._slots.length;a>e;++e){var i=this._slots[e],n=i.childArmature;n&&(n.cacheFrameRate=t)}}}),r.enableAnimationCache=function(t){this.cacheFrameRate=t},r.hasEventListener=function(t){this._display.hasEvent(t)},r.addEventListener=function(t,e,a){this._display.addEvent(t,e,a)},r.removeEventListener=function(t,e,a){this._display.removeEvent(t,e,a)},r.getDisplay=function(){return this._display},a}(t.BaseObject);t.Armature=e,egret.registerClass(e,"dragonBones.Armature",["dragonBones.IAnimateble"])}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(e){function a(){e.call(this),this.global=new t.Transform,this.origin=new t.Transform,this.offset=new t.Transform,this._globalTransformMatrix=new t.Matrix}__extends(a,e);var i=__define,n=a,r=n.prototype;return r._onClear=function(){this.userData=null,this.name=null,this.globalTransformMatrix=this._globalTransformMatrix,this.global.identity(),this.origin.identity(),this.offset.identity(),this._armature=null,this._parent=null,this._globalTransformMatrix.identity()},r._setArmature=function(t){this._armature=t},r._setParent=function(t){this._parent=t},i(r,"armature",function(){return this._armature}),i(r,"parent",function(){return this._parent}),a}(t.BaseObject);t.TransformObject=e,egret.registerClass(e,"dragonBones.TransformObject")}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(e){function a(){e.call(this),this._animationPose=new t.Transform,this._bones=[],this._slots=[]}__extends(a,e);var i=__define,n=a,r=n.prototype;return a.toString=function(){return"[class dragonBones.Bone]"},r._onClear=function(){e.prototype._onClear.call(this),this.inheritTranslation=!1,this.inheritRotation=!1,this.inheritScale=!1,this.ikBendPositive=!1,this.ikWeight=0,this.length=0,this._transformDirty=2,this._blendIndex=0,this._cacheFrames=null,this._animationPose.identity(),this._visible=!0,this._ikChain=0,this._ikChainIndex=0,this._ik=null,this._bones.length&&(this._bones.length=0),this._slots.length&&(this._slots.length=0)},r._updateGlobalTransformMatrix=function(){if(this._parent){var t=this._parent.global.skewY,e=this._parent.globalTransformMatrix;if(this.inheritScale)this.inheritRotation||(this.global.skewX-=t,this.global.skewY-=t),this.global.toMatrix(this.globalTransformMatrix),this.globalTransformMatrix.concat(e),this.inheritTranslation||(this.globalTransformMatrix.tx=this.global.x,this.globalTransformMatrix.ty=this.global.y),this.global.fromMatrix(this.globalTransformMatrix);else{if(this.inheritTranslation){var a=this.global.x,i=this.global.y;this.global.x=e.a*a+e.c*i+e.tx,this.global.y=e.d*i+e.b*a+e.ty}this.inheritRotation&&(this.global.skewX+=t,this.global.skewY+=t),this.global.toMatrix(this.globalTransformMatrix)}}else this.global.toMatrix(this.globalTransformMatrix)},r._computeIKA=function(){var t=this._ik.global,e=this.globalTransformMatrix.a*this.length,a=this.globalTransformMatrix.b*this.length,i=(Math.atan2(t.y-this.global.y,t.x-this.global.x)+this.offset.skewY-2*this.global.skewY+Math.atan2(a,e))*this.ikWeight;this.global.skewX+=i,this.global.skewY+=i,this.global.toMatrix(this.globalTransformMatrix)},r._computeIKB=function(){var t=this._parent.global,e=this._ik.global,a=this.globalTransformMatrix.a*this.length,i=this.globalTransformMatrix.b*this.length,n=a*a+i*i,r=Math.sqrt(n),s=this.global.x-t.x,o=this.global.y-t.y,l=s*s+o*o,h=Math.sqrt(l);s=e.x-t.x,o=e.y-t.y;var _=s*s+o*o,u=Math.sqrt(_),m=0;if(u>=r+h||h>=u+r||r>=u+h)m=Math.atan2(e.y-t.y,e.x-t.x)+this._parent.offset.skewY,u>=r+h||r>h&&(m+=Math.PI);else{var f=(l-n+_)/(2*_),c=Math.sqrt(l-f*f*_)/u,d=t.x+s*f,g=t.y+o*f,p=-o*c,v=s*c;this.ikBendPositive?(this.global.x=d-p,this.global.y=g-v):(this.global.x=d+p,this.global.y=g+v),m=Math.atan2(this.global.y-t.y,this.global.x-t.x)+this._parent.offset.skewY}m=(m-t.skewY)*this.ikWeight,t.skewX+=m,t.skewY+=m,t.toMatrix(this._parent.globalTransformMatrix),this._parent._transformDirty=1,this.global.x=t.x+Math.cos(t.skewY)*h,this.global.y=t.y+Math.sin(t.skewY)*h;var T=(Math.atan2(e.y-this.global.y,e.x-this.global.x)+this.offset.skewY-2*this.global.skewY+Math.atan2(i,a))*this.ikWeight;this.global.skewX+=T,this.global.skewY+=T,this.global.toMatrix(this.globalTransformMatrix)},r._setArmature=function(t){if(this._armature!=t){this._ik=null;var e=null,a=null;if(this._armature&&(e=this.getSlots(),a=this.getBones(),this._armature._removeBoneFromBoneList(this)),this._armature=t,this._armature&&this._armature._addBoneToBoneList(this),e)for(var i=0,n=e.length;n>i;++i){var r=e[i];r.parent==this&&r._setArmature(this._armature)}if(a)for(var i=0,n=a.length;n>i;++i){var s=a[i];s.parent==this&&s._setArmature(this._armature)}}},r._setIK=function(t,e,a){if(t){if(e==a){var i=this._parent;if(e&&i?e=1:(e=0,a=0,i=this),i==t||i.contains(t))t=null,e=0,a=0;else for(var n=t;n.ik&&n.ikChain;){if(i.contains(n.ik)){t=null,e=0,a=0;break}n=n.parent}}}else e=0,a=0;this._ik=t,this._ikChain=e,this._ikChainIndex=a,this._armature&&(this._armature._bonesDirty=!0)},r._update=function(e){var a=this;if(a._blendIndex=0,e>=0){var i=a._cacheFrames[e];a.globalTransformMatrix==i?a._transformDirty=0:i?(a._transformDirty=2,a.globalTransformMatrix=i):2==a._transformDirty||a._parent&&0!=a._parent._transformDirty||a._ik&&a.ikWeight>0&&0!=a._ik._transformDirty?(a._transformDirty=2,a.globalTransformMatrix=a._globalTransformMatrix):a.globalTransformMatrix!=a._globalTransformMatrix?(a._transformDirty=0,a._cacheFrames[e]=a.globalTransformMatrix):(a._transformDirty=2,a.globalTransformMatrix=a._globalTransformMatrix)}else(2==a._transformDirty||a._parent&&0!=a._parent._transformDirty||a._ik&&a.ikWeight>0&&0!=a._ik._transformDirty)&&(a._transformDirty=2,a.globalTransformMatrix=a._globalTransformMatrix);0!=a._transformDirty&&(2==a._transformDirty?(a._transformDirty=1,a.globalTransformMatrix==a._globalTransformMatrix&&(a.global.x=a.origin.x+a.offset.x+a._animationPose.x,a.global.y=a.origin.y+a.offset.y+a._animationPose.y,a.global.skewX=a.origin.skewX+a.offset.skewX+a._animationPose.skewX,a.global.skewY=a.origin.skewY+a.offset.skewY+a._animationPose.skewY,a.global.scaleX=a.origin.scaleX*a.offset.scaleX*a._animationPose.scaleX,a.global.scaleY=a.origin.scaleY*a.offset.scaleY*a._animationPose.scaleY,a._updateGlobalTransformMatrix(),a._ik&&a._ikChainIndex==a._ikChain&&a.ikWeight>0&&(a.inheritTranslation&&a._ikChain>0&&a._parent?a._computeIKB():a._computeIKA()),e>=0&&(a.globalTransformMatrix=t.BoneTimelineData.cacheFrame(a._cacheFrames,e,a._globalTransformMatrix)))):a._transformDirty=0)},r.invalidUpdate=function(){this._transformDirty=2},r.contains=function(t){if(t){if(t==this)return!1;for(var e=t;e!=this&&e;)e=e.parent;return e==this}return!1},r.getBones=function(){this._bones.length=0;for(var t=this._armature.getBones(),e=0,a=t.length;a>e;++e){var i=t[e];i.parent==this&&this._bones.push(i)}return this._bones},r.getSlots=function(){this._slots.length=0;for(var t=this._armature.getSlots(),e=0,a=t.length;a>e;++e){var i=t[e];i.parent==this&&this._slots.push(i)}return this._slots},i(r,"ikChain",function(){return this._ikChain}),i(r,"ikChainIndex",function(){return this._ikChainIndex}),i(r,"ik",function(){return this._ik}),i(r,"visible",function(){return this._visible},function(t){if(this._visible!=t){this._visible=t;for(var e=this._armature.getSlots(),a=0,i=e.length;i>a;++a){var n=e[a];n._parent==this&&n._updateVisible()}}}),i(r,"slot",function(){for(var t=this._armature.getSlots(),e=0,a=t.length;a>e;++e){var i=t[e];if(i.parent==this)return i}return null}),a}(t.TransformObject);t.Bone=e,egret.registerClass(e,"dragonBones.Bone")}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(e){function a(){e.call(this),this._colorTransform=new t.ColorTransform,this._ffdVertices=[],this._replacedDisplayDataSet=[],this._localMatrix=new t.Matrix,this._displayList=[],this._meshBones=[]}__extends(a,e);var i=__define,n=a,r=n.prototype;return r._onClear=function(){e.prototype._onClear.call(this);for(var a=[],i=0,n=this._displayList.length;n>i;++i){var r=this._displayList[i];r!=this._rawDisplay&&r!=this._meshDisplay&&a.indexOf(r)<0&&a.push(r)}for(var i=0,n=a.length;n>i;++i){var r=a[i];r instanceof t.Armature?r.dispose():this._disposeDisplay(r)}this._meshDisplay&&this._meshDisplay!=this._rawDisplay&&this._disposeDisplay(this._meshDisplay),this._rawDisplay&&this._disposeDisplay(this._rawDisplay),this.inheritAnimation=!0,this.displayController=null,this._colorDirty=!1,this._ffdDirty=!1,this._blendIndex=0,this._zOrder=0,this._pivotX=0,this._pivotY=0,this._displayDataSet=null,this._meshData=null,this._childArmature=null,this._rawDisplay=null,this._meshDisplay=null,this._cacheFrames=null,this._colorTransform.identity(),this._ffdVertices.length&&(this._ffdVertices.length=0),this._replacedDisplayDataSet.length&&(this._replacedDisplayDataSet.length=0),this._displayDirty=!1,this._blendModeDirty=!1,this._originDirty=!1,this._transformDirty=!1,this._displayIndex=0,this._blendMode=0,this._display=null,this._localMatrix.identity(),this._displayList.length&&(this._displayList.length=0),this._meshBones.length&&(this._meshBones.length=0)},r._isMeshBonesUpdate=function(){for(var t=0,e=this._meshBones.length;e>t;++t)if(0!=this._meshBones[t]._transformDirty)return!0;return!1},r._updateDisplay=function(){var e=this._display||this._rawDisplay,a=this._childArmature;this._displayIndex>=0&&this._displayIndex<this._displayList.length?(this._display=this._displayList[this._displayIndex],this._display instanceof t.Armature?(this._childArmature=this._display,this._display=this._childArmature._display):this._childArmature=null):(this._display=null,this._childArmature=null);var i=this._display||this._rawDisplay;if(i!=e&&(this._onUpdateDisplay(),e?this._replaceDisplay(e):this._addDisplay(),this._blendModeDirty=!0,this._colorDirty=!0),this._displayDataSet&&this._displayIndex>=0&&this._displayIndex<this._displayDataSet.displays.length&&(this.origin.copyFrom(this._displayDataSet.displays[this._displayIndex].transform),this._originDirty=!0),this._updateMeshData(!1),(i==this._rawDisplay||i==this._meshDisplay)&&this._updateFrame(),this._childArmature!=a&&(a&&(a._parent=null,this.inheritAnimation&&a.animation.reset()),this._childArmature&&(this._childArmature._parent=this,this.inheritAnimation))){var n=this._armature.cacheFrameRate;n&&(this._childArmature.cacheFrameRate=n);var r=this._armature.armatureData.getSlot(this.name),s=r.actions.length>0?r.actions:this._childArmature.armatureData.actions;if(s.length>0)for(var o=0,l=s.length;l>o;++o)this._childArmature._bufferAction(s[o]);else this._childArmature.animation.play()}},r._updateLocalTransformMatrix=function(){this.global.copyFrom(this.origin).add(this.offset).toMatrix(this._localMatrix)},r._updateGlobalTransformMatrix=function(){this.globalTransformMatrix.copyFrom(this._localMatrix),this.globalTransformMatrix.concat(this._parent.globalTransformMatrix),this.global.fromMatrix(this.globalTransformMatrix)},r._setArmature=function(t){this._armature!=t&&(this._armature&&this._armature._removeSlotFromSlotList(this),this._armature=t,this._onUpdateDisplay(),this._armature?(this._armature._addSlotToSlotList(this),this._addDisplay()):this._removeDisplay())},r._updateMeshData=function(t){var e=this._meshData;if(this._meshDisplay&&this._displayDataSet&&this._displayIndex>=0&&this._displayIndex<this._displayDataSet.displays.length?this._meshData=this._displayDataSet.displays[this._displayIndex].mesh:this._meshData=null,this._meshData!=e){if(this._meshData){if(this._meshData.skinned){this._meshBones.length=this._meshData.bones.length;for(var a=0,i=this._meshBones.length;i>a;++a)this._meshBones[a]=this._armature.getBone(this._meshData.bones[a].name);for(var n=0,a=0,i=this._meshData.boneIndices.length;i>a;++a)n+=this._meshData.boneIndices[a].length;this._ffdVertices.length=2*n}else this._meshBones.length=0,this._ffdVertices.length=this._meshData.vertices.length;for(var a=0,i=this._ffdVertices.length;i>a;++a)this._ffdVertices[a]=0;this._ffdDirty=!0}else this._meshBones.length=0,this._ffdVertices.length=0;t&&this._armature.animation._updateFFDTimelineStates()}},r._update=function(e){var a=this;if(a._blendIndex=0,a._displayDirty&&(a._displayDirty=!1,a._updateDisplay()),a._display&&(a._blendModeDirty&&(a._blendModeDirty=!1,a._updateBlendMode()),a._colorDirty&&(a._colorDirty=!1,a._updateColor()),!a._meshData||((a._ffdDirty||a._meshData.skinned&&a._isMeshBonesUpdate())&&(a._ffdDirty=!1,a._updateMesh()),!a._meshData.skinned))){if(a._originDirty&&(a._originDirty=!1,a._transformDirty=!0,a._updateLocalTransformMatrix()),e>=0){var i=a._cacheFrames[e];a.globalTransformMatrix==i?a._transformDirty=!1:i?(a._transformDirty=!0,a.globalTransformMatrix=i):a._transformDirty||0!=a._parent._transformDirty?(a._transformDirty=!0,a.globalTransformMatrix=a._globalTransformMatrix):a.globalTransformMatrix!=a._globalTransformMatrix?(a._transformDirty=!1,a._cacheFrames[e]=a.globalTransformMatrix):(a._transformDirty=!0,a.globalTransformMatrix=a._globalTransformMatrix)}else(a._transformDirty||0!=a._parent._transformDirty)&&(a._transformDirty=!0,a.globalTransformMatrix=a._globalTransformMatrix);a._transformDirty&&(a._transformDirty=!1,a.globalTransformMatrix==a._globalTransformMatrix&&(a._updateGlobalTransformMatrix(),e>=0&&!a._cacheFrames[e]&&(a.globalTransformMatrix=t.SlotTimelineData.cacheFrame(a._cacheFrames,e,a._globalTransformMatrix))),a._updateTransform())}},r._setDisplayList=function(e){if(e&&e.length){this._displayList.length!=e.length&&(this._displayList.length=e.length);for(var a=0,i=this._displayList.length;i>a;++a){var n=e[a];n&&n!=this._rawDisplay&&n!=this._meshDisplay&&!(n instanceof t.Armature)&&this._displayList.indexOf(n)<0&&this._initDisplay(n),this._displayList[a]=n}}else this._displayList.length&&(this._displayList.length=0);return this._displayIndex>=0&&this._displayIndex<this._displayList.length?this._displayDirty=this._display!=this._displayList[this._displayIndex]:this._displayDirty=null!=this._display,this._displayDirty},r._setDisplayIndex=function(t){return this._displayIndex==t?!1:(this._displayIndex=t,this._displayDirty=!0,this._displayDirty)},r._setBlendMode=function(t){return this._blendMode==t?!1:(this._blendMode=t,this._blendModeDirty=!0,!0)},r._setColor=function(t){return this._colorTransform.copyFrom(t),this._colorDirty=!0,!0},r.invalidUpdate=function(){this._originDirty=!0},i(r,"rawDisplay",function(){return this._rawDisplay}),i(r,"MeshDisplay",function(){return this._meshDisplay}),i(r,"displayIndex",function(){return this._displayIndex},function(t){this._setDisplayIndex(t)&&this._update(-1)}),i(r,"displayList",function(){return this._displayList.concat()},function(e){var a=this._displayList.concat(),i=[];this._setDisplayList(e)&&this._update(-1);for(var n=0,r=a.length;r>n;++n){var s=a[n];s!=this._rawDisplay&&s!=this._meshDisplay&&this._displayList.indexOf(s)<0&&i.indexOf(s)<0&&i.push(s)}for(var n=0,r=i.length;r>n;++n){var s=i[n];s instanceof t.Armature?s.dispose():this._disposeDisplay(s)}}),i(r,"display",function(){return this._display},function(t){if(this._display!=t){var e=this._displayList.length;if(this._displayIndex<0&&0==e&&(this._displayIndex=0),!(this._displayIndex<0)){var a=this.displayList;e<=this._displayIndex&&(a.length=this._displayIndex+1),a[this._displayIndex]=t,this.displayList=a}}}),i(r,"childArmature",function(){return this._childArmature},function(t){this._childArmature!=t&&(t&&t.display.advanceTimeBySelf(!1),this.display=t)}),r.getDisplay=function(){return this._display},r.setDisplay=function(t){this.display=t},a}(t.TransformObject);t.Slot=e,egret.registerClass(e,"dragonBones.Slot")}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(){function t(){}var e=(__define,t);e.prototype;return t.hasArmature=function(e){return t._armatures.indexOf(e)>=0},t.addArmature=function(e){e&&t._armatures.indexOf(e)<0&&t._armatures.push(e)},t.removeArmature=function(e){if(e){var a=t._armatures.indexOf(e);a>=0&&t._armatures.splice(a,1)}},t.PI_D=2*Math.PI,t.PI_H=Math.PI/2,t.PI_Q=Math.PI/4,t.ANGLE_TO_RADIAN=Math.PI/180,t.RADIAN_TO_ANGLE=180/Math.PI,t.SECOND_TO_MILLISECOND=1e3,t.NO_TWEEN=100,t.VERSION="4.7.2",t.debug=!1,t.debugDraw=!1,t._armatures=[],t}();t.DragonBones=e,egret.registerClass(e,"dragonBones.DragonBones")}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(t){function e(){t.call(this)}__extends(e,t);var a=__define,i=e,n=i.prototype;return e.toString=function(){return"[class dragonBones.EventObject]"},n._onClear=function(){this.type=null,this.name=null,this.data=null,this.armature=null,this.bone=null,this.slot=null,this.animationState=null,this.frame=null,this.userData=null},a(n,"animationName",function(){return this.animationState.name}),e.START="start",e.LOOP_COMPLETE="loopComplete",e.COMPLETE="complete",e.FADE_IN="fadeIn",e.FADE_IN_COMPLETE="fadeInComplete",e.FADE_OUT="fadeOut",e.FADE_OUT_COMPLETE="fadeOutComplete",e.FRAME_EVENT="frameEvent",e.SOUND_EVENT="soundEvent",e._soundEventManager=null,e}(t.BaseObject);t.EventObject=e,egret.registerClass(e,"dragonBones.EventObject")}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(t){function e(){t.call(this),this.textures={}}__extends(e,t);var a=(__define,e),i=a.prototype;return i._onClear=function(){this.autoSearch=!1,this.scale=1,this.name=null,this.imagePath=null;for(var t in this.textures)this.textures[t].returnToPool(),delete this.textures[t]},i.dispose=function(){this.returnToPool()},i.addTexture=function(t){t&&t.name&&!this.textures[t.name]&&(this.textures[t.name]=t,t.parent=this)},i.getTexture=function(t){return this.textures[t]},e}(t.BaseObject);t.TextureAtlasData=e,egret.registerClass(e,"dragonBones.TextureAtlasData");var a=function(e){function a(){e.call(this),this.region=new t.Rectangle}__extends(a,e);var i=(__define,a),n=i.prototype;return a.generateRectangle=function(){return new t.Rectangle},n._onClear=function(){this.rotated=!1,this.name=null,this.frame=null,this.parent=null,this.region.clear()},a}(t.BaseObject);t.TextureData=a,egret.registerClass(a,"dragonBones.TextureData")}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(e){function i(){e.call(this)}__extends(i,e);var n=(__define,i),r=n.prototype;return i.toString=function(){return"[class dragonBones.EgretTextureAtlasData]"},r._onClear=function(){e.prototype._onClear.call(this),this.texture&&(this.texture=null)},r.generateTextureData=function(){return t.BaseObject.borrowObject(a)},i}(t.TextureAtlasData);t.EgretTextureAtlasData=e,egret.registerClass(e,"dragonBones.EgretTextureAtlasData");var a=function(t){function e(){t.call(this)}__extends(e,t);var a=(__define,e),i=a.prototype;return e.toString=function(){return"[class dragonBones.EgretTextureData]"},i._onClear=function(){t.prototype._onClear.call(this),this.texture&&(this.texture.dispose(),this.texture=null)},e}(t.TextureData);t.EgretTextureData=a,egret.registerClass(a,"dragonBones.EgretTextureData")}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(e){function a(t,a,i,n){e.call(this,t,a,i,n)}__extends(a,e);var i=__define,n=a,r=n.prototype;return i(r,"eventObject",function(){return this.data}),i(r,"frameLabel",function(){return this.eventObject.name}),i(r,"sound",function(){return this.eventObject.name}),i(r,"animationName",function(){return this.eventObject.animationState.name}),i(r,"armature",function(){return this.eventObject.armature}),i(r,"bone",function(){return this.eventObject.bone}),i(r,"slot",function(){return this.eventObject.slot}),i(r,"animationState",function(){return this.eventObject.animationState}),i(r,"movementID",function(){return this.animationName}),a.START=t.EventObject.START,a.LOOP_COMPLETE=t.EventObject.LOOP_COMPLETE,a.COMPLETE=t.EventObject.COMPLETE,a.FADE_IN=t.EventObject.FADE_IN,a.FADE_IN_COMPLETE=t.EventObject.FADE_IN_COMPLETE,a.FADE_OUT=t.EventObject.FADE_OUT,a.FADE_OUT_COMPLETE=t.EventObject.FADE_OUT_COMPLETE,a.FRAME_EVENT=t.EventObject.FRAME_EVENT,a.SOUND_EVENT=t.EventObject.SOUND_EVENT,a.ANIMATION_FRAME_EVENT=t.EventObject.FRAME_EVENT,a.BONE_FRAME_EVENT=t.EventObject.FRAME_EVENT,a.MOVEMENT_FRAME_EVENT=t.EventObject.FRAME_EVENT,a.SOUND=t.EventObject.SOUND_EVENT,a}(egret.Event);t.EgretEvent=e,egret.registerClass(e,"dragonBones.EgretEvent");var a=function(a){function i(){a.call(this),i._clock||(i._clock=new t.WorldClock,i._clock.time=.001*egret.getTimer(),egret.startTick(i._clockHandler,i))}__extends(i,a);var n=__define,r=i,s=r.prototype;return i._clockHandler=function(t){t*=.001;var e=i.passTime>0?i.passTime:t-i._clock.time;return i._clock.advanceTime(e),i._clock.time=t,!1},s._onClear=function(){this._armature=null,this._debugDrawer=null},s._dispatchEvent=function(t){var a=egret.Event.create(e,t.type);a.data=t,this.dispatchEvent(a),egret.Event.release(a)},s._debugDraw=function(){this._debugDrawer||(this._debugDrawer=new egret.Shape),this.addChild(this._debugDrawer),this._debugDrawer.graphics.clear();for(var t=this._armature.getBones(),e=0,a=t.length;a>e;++e){var i=t[e],n=Math.max(i.length,5),r=i.globalTransformMatrix.tx,s=i.globalTransformMatrix.ty,o=r+i.globalTransformMatrix.a*n,l=s+i.globalTransformMatrix.b*n;this._debugDrawer.graphics.lineStyle(1,i.ik?16711680:65280,.5),this._debugDrawer.graphics.moveTo(r,s),this._debugDrawer.graphics.lineTo(o,l)}},s.hasEvent=function(t){return this.hasEventListener(t)
},s.addEvent=function(t,e,a){this.addEventListener(t,e,a)},s.removeEvent=function(t,e,a){this.removeEventListener(t,e,a)},s.advanceTimeBySelf=function(t){t?i._clock.add(this._armature):i._clock.remove(this._armature)},s.dispose=function(){this._armature&&(this.advanceTimeBySelf(!1),this._armature.dispose(),this._armature=null)},n(s,"armature",function(){return this._armature}),n(s,"animation",function(){return this._armature.animation}),i.passTime=0,i._clock=null,i}(egret.DisplayObjectContainer);t.EgretArmatureDisplay=a,egret.registerClass(a,"dragonBones.EgretArmatureDisplay",["dragonBones.IArmatureDisplay","dragonBones.IEventDispatcher"]);var i=function(t){function e(){t.apply(this,arguments)}__extends(e,t);var a=(__define,e);a.prototype;return e}(e);t.AnimationEvent=i,egret.registerClass(i,"dragonBones.AnimationEvent");var n=function(t){function e(){t.apply(this,arguments)}__extends(e,t);var a=(__define,e);a.prototype;return e}(e);t.FrameEvent=n,egret.registerClass(n,"dragonBones.FrameEvent");var r=function(t){function e(){t.apply(this,arguments)}__extends(e,t);var a=(__define,e);a.prototype;return e}(e);t.SoundEvent=r,egret.registerClass(r,"dragonBones.SoundEvent");var s=function(e){function a(a,i,n){void 0===n&&(n=1),e.call(this),this._onClear(),this.texture=a,t.ObjectDataParser.getInstance().parseTextureAtlasData(i,this,n)}__extends(a,e);var i=(__define,a);i.prototype;return a.toString=function(){return"[class dragonBones.EgretTextureAtlas]"},a}(t.EgretTextureAtlasData);t.EgretTextureAtlas=s,egret.registerClass(s,"dragonBones.EgretTextureAtlas");var o=function(t){function e(){t.apply(this,arguments)}__extends(e,t);var a=(__define,e);a.prototype;return e}(s);t.EgretSheetAtlas=o,egret.registerClass(o,"dragonBones.EgretSheetAtlas");var l=function(){function e(){}var a=(__define,e);a.prototype;return e.getInstance=function(){return t.EventObject._soundEventManager},e}();t.SoundEventManager=l,egret.registerClass(l,"dragonBones.SoundEventManager");var h=function(){function t(){}var e=(__define,t);e.prototype;return t}();t.AnimationCacheManager=h,egret.registerClass(h,"dragonBones.AnimationCacheManager")}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(){function t(t,e,a,i,n,r,s,o){void 0===t&&(t=1),void 0===e&&(e=1),void 0===a&&(a=1),void 0===i&&(i=1),void 0===n&&(n=0),void 0===r&&(r=0),void 0===s&&(s=0),void 0===o&&(o=0),this.alphaMultiplier=t,this.redMultiplier=e,this.greenMultiplier=a,this.blueMultiplier=i,this.alphaOffset=n,this.redOffset=r,this.greenOffset=s,this.blueOffset=o}var e=(__define,t),a=e.prototype;return a.copyFrom=function(t){this.alphaMultiplier=t.alphaMultiplier,this.redMultiplier=t.redMultiplier,this.greenMultiplier=t.greenMultiplier,this.blueMultiplier=t.blueMultiplier,this.alphaOffset=t.alphaOffset,this.redOffset=t.redOffset,this.redOffset=t.redOffset,this.greenOffset=t.blueOffset},a.identity=function(){this.alphaMultiplier=this.redMultiplier=this.greenMultiplier=this.blueMultiplier=1,this.alphaOffset=this.redOffset=this.greenOffset=this.blueOffset=0},t}();t.ColorTransform=e,egret.registerClass(e,"dragonBones.ColorTransform")}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(){function e(e){void 0===e&&(e=null),this.autoSearch=!1,this._dataParser=null,this._dragonBonesDataMap={},this._textureAtlasDataMap={},this._dataParser=e||t.ObjectDataParser.getInstance()}var a=(__define,e),i=a.prototype;return i._getTextureData=function(t,e){var a=this._textureAtlasDataMap[t];if(a)for(var i=0,n=a.length;n>i;++i){var r=a[i].getTexture(e);if(r)return r}if(this.autoSearch)for(var i in this._textureAtlasDataMap){a=this._textureAtlasDataMap[i];for(var s=0,o=a.length;o>s;++s){var l=a[s];if(l.autoSearch){var r=l.getTexture(e);if(r)return r}}}return null},i._fillBuildArmaturePackage=function(t,e,a,i){if(t){var n=this._dragonBonesDataMap[t];if(n){var r=n.getArmature(e);if(r)return i.dataName=t,i.data=n,i.armature=r,i.skin=r.getSkin(a),i.skin||(i.skin=r.defaultSkin),!0}}if(!t||this.autoSearch)for(var s in this._dragonBonesDataMap){var n=this._dragonBonesDataMap[s];if(!t||n.autoSearch){var r=n.getArmature(e);if(r)return i.dataName=s,i.data=n,i.armature=r,i.skin=r.getSkin(a),i.skin||(i.skin=r.defaultSkin),!0}}return!1},i._buildBones=function(e,a){for(var i=e.armature.sortedBones,n=0,r=i.length;r>n;++n){var s=i[n],o=t.BaseObject.borrowObject(t.Bone);o.name=s.name,o.inheritTranslation=s.inheritTranslation,o.inheritRotation=s.inheritRotation,o.inheritScale=s.inheritScale,o.length=s.length,o.origin.copyFrom(s.transform),s.parent?a.addBone(o,s.parent.name):a.addBone(o),s.ik&&(o.ikBendPositive=s.bendPositive,o.ikWeight=s.weight,o._setIK(a.getBone(s.ik.name),s.chain,s.chainIndex))}},i._buildSlots=function(t,e){var a=t.skin,i=t.armature.defaultSkin,n={};for(var r in i.slots){var s=i.slots[r];n[s.slot.name]=s}if(a!=i)for(var r in a.slots){var s=a.slots[r];n[s.slot.name]=s}for(var o=t.armature.sortedSlots,r=0,l=o.length;l>r;++r){var h=o[r],s=n[h.name];if(s){var _=this._generateSlot(t,s);_&&(_._displayDataSet=s,_._setDisplayIndex(h.displayIndex),_._setBlendMode(h.blendMode),_._setColor(h.color),_._replacedDisplayDataSet.length=_._displayDataSet.displays.length,e.addSlot(_,h.parent.name))}}},i._replaceSlotDisplay=function(t,e,a,i){if(0>i&&(i=a.displayIndex),i>=0){var n=a.displayList;if(n.length<=i&&(n.length=i+1),e.textureData||(e.textureData=this._getTextureData(t.dataName,e.name)),1==e.type){var r=this.buildArmature(e.name,t.dataName);n[i]=r}else a._replacedDisplayDataSet.length<=i&&(a._replacedDisplayDataSet.length=i+1),a._replacedDisplayDataSet[i]=e,e.mesh?n[i]=a.MeshDisplay:n[i]=a.rawDisplay;a.displayList=n,a.invalidUpdate()}},i.parseDragonBonesData=function(t,e){void 0===e&&(e=null);var a=this._dataParser.parseDragonBonesData(t,1);return this.addDragonBonesData(a,e),a},i.parseTextureAtlasData=function(t,e,a,i){void 0===a&&(a=null),void 0===i&&(i=0);var n=this._generateTextureAtlasData(null,null);return this._dataParser.parseTextureAtlasData(t,n,i),this._generateTextureAtlasData(n,e),this.addTextureAtlasData(n,a),n},i.getDragonBonesData=function(t){return this._dragonBonesDataMap[t]},i.addDragonBonesData=function(t,e){if(void 0===e&&(e=null),!t)throw new Error;e=e||t.name,e?this._dragonBonesDataMap[e]?console.warn("Same name data."):this._dragonBonesDataMap[e]=t:console.warn("Unnamed data.")},i.removeDragonBonesData=function(e,a){void 0===a&&(a=!0);var i=this._dragonBonesDataMap[e];if(i){if(a){if(t.DragonBones.debug)for(var n=0,r=t.DragonBones._armatures.length;r>n;++n){var s=t.DragonBones._armatures[n];if(s.armatureData.parent==i)throw new Error("ArmatureData: "+s.armatureData.name+" DragonBonesData: "+e)}i.returnToPool()}delete this._dragonBonesDataMap[e]}},i.getTextureAtlasData=function(t){return this._textureAtlasDataMap[t]},i.addTextureAtlasData=function(t,e){if(void 0===e&&(e=null),!t)throw new Error;if(e=e||t.name){var a=this._textureAtlasDataMap[e]=this._textureAtlasDataMap[e]||[];a.indexOf(t)<0&&a.push(t)}else console.warn("Unnamed data.")},i.removeTextureAtlasData=function(t,e){void 0===e&&(e=!0);var a=this._textureAtlasDataMap[t];if(a){if(e)for(var i=0,n=a.length;n>i;++i)a[i].returnToPool();delete this._textureAtlasDataMap[t]}},i.clear=function(t){void 0===t&&(t=!0);for(var e in this._dragonBonesDataMap)t&&this._dragonBonesDataMap[e].returnToPool(),delete this._dragonBonesDataMap[e];for(var e in this._textureAtlasDataMap){if(t)for(var a=this._textureAtlasDataMap[e],i=0,n=a.length;n>i;++i)a[i].returnToPool();delete this._textureAtlasDataMap[e]}},i.buildArmature=function(t,e,a){void 0===e&&(e=null),void 0===a&&(a=null);var i={};if(this._fillBuildArmaturePackage(e,t,a,i)){var n=this._generateArmature(i);return this._buildBones(i,n),this._buildSlots(i,n),n.advanceTime(0),n}return null},i.copyAnimationsToArmature=function(e,a,i,n,r){void 0===i&&(i=null),void 0===n&&(n=null),void 0===r&&(r=!0);var s={};if(this._fillBuildArmaturePackage(n,a,i,s)){var o=s.armature;if(r)e.animation.animations=o.animations;else{var l={};for(var h in e.animation.animations)l[h]=e.animation.animations[h];for(var h in o.animations)l[h]=o.animations[h];e.animation.animations=l}if(s.skin){for(var _=e.getSlots(),u=0,m=_.length;m>u;++u)for(var f=_[u],c=f.displayList,d=0,g=c.length;g>d;++d){var p=c[d];if(p instanceof t.Armature){var v=s.skin.getSlot(f.name).displays;if(d<v.length){var T=v[d];1==T.type&&this.copyAnimationsToArmature(p,T.name,i,n,r)}}}return!0}}return!1},i.replaceSlotDisplay=function(t,e,a,i,n,r){void 0===r&&(r=-1);var s={};if(this._fillBuildArmaturePackage(t,e,null,s)){var o=s.skin.getSlot(a);if(o)for(var l=0,h=o.displays.length;h>l;++l){var _=o.displays[l];if(_.name==i){this._replaceSlotDisplay(s,_,n,r);break}}}},i.replaceSlotDisplayList=function(t,e,a,i){var n={};if(this._fillBuildArmaturePackage(t,e,null,n)){var r=n.skin.getSlot(a);if(r)for(var s=0,o=0,l=r.displays.length;l>o;++o){var h=r.displays[o];this._replaceSlotDisplay(n,h,i,s++)}}},i.dispose=function(){this.clear()},e}();t.BaseFactory=e,egret.registerClass(e,"dragonBones.BaseFactory")}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(e){function a(a){void 0===a&&(a=null),e.call(this,a),t.EventObject._soundEventManager||(t.EventObject._soundEventManager=new t.EgretArmatureDisplay)}__extends(a,e);var i=__define,n=a,r=n.prototype;return i(a,"factory",function(){return a._factory||(a._factory=new a),a._factory}),r._generateTextureAtlasData=function(e,a){return e?e.texture=a:e=t.BaseObject.borrowObject(t.EgretTextureAtlasData),e},r._generateArmature=function(e){var a=t.BaseObject.borrowObject(t.Armature),i=new t.EgretArmatureDisplay;return a._armatureData=e.armature,a._skinData=e.skin,a._animation=t.BaseObject.borrowObject(t.Animation),a._display=i,i._armature=a,a._animation._armature=a,a.animation.animations=e.armature.animations,a},r._generateSlot=function(e,a){var i=t.BaseObject.borrowObject(t.EgretSlot),n=a.slot,r=[];i.name=n.name,i._rawDisplay=new egret.Bitmap;for(var s=0,o=a.displays.length;o>s;++s){var l=a.displays[s];switch(l.type){case 0:l.textureData||(l.textureData=this._getTextureData(e.dataName,l.name)),r.push(i._rawDisplay);break;case 2:l.textureData||(l.textureData=this._getTextureData(e.dataName,l.name)),"webgl"==egret.Capabilities.renderMode?(i._meshDisplay||(i._meshDisplay=new egret.Mesh),r.push(i._meshDisplay)):r.push(i._rawDisplay);break;case 1:var h=this.buildArmature(l.name,e.dataName);if(h){if(!i.inheritAnimation){var _=n.actions.length>0?n.actions:h.armatureData.actions;if(_.length>0)for(var u=0,m=_.length;m>u;++u)h._bufferAction(_[u]);else h.animation.play()}l.armatureData=h.armatureData}r.push(h);break;default:r.push(null)}}return i._setDisplayList(r),i},r.buildArmatureDisplay=function(t,e,a){void 0===e&&(e=null),void 0===a&&(a=null);var i=this.buildArmature(t,e,a),n=i?i._display:null;return n&&n.advanceTimeBySelf(!0),n},r.getTextureDisplay=function(t,e){void 0===e&&(e=null);var a=this._getTextureData(e,t);return a?new egret.Bitmap(a.texture):null},i(r,"soundEventManater",function(){return t.EventObject._soundEventManager}),r.addSkeletonData=function(t,e){void 0===e&&(e=null),this.addDragonBonesData(t,e)},r.getSkeletonData=function(t){return this.getDragonBonesData(t)},r.removeSkeletonData=function(t){this.removeDragonBonesData(t)},r.addTextureAtlas=function(t,e){void 0===e&&(e=null),this.addTextureAtlasData(t,e)},r.getTextureAtlas=function(t){return this.getTextureAtlasData(t)},r.removeTextureAtlas=function(t){this.removeTextureAtlasData(t)},r.buildFastArmature=function(t,e,a){return void 0===e&&(e=null),void 0===a&&(a=null),this.buildArmature(t,e,a)},a._factory=null,a}(t.BaseFactory);t.EgretFactory=e,egret.registerClass(e,"dragonBones.EgretFactory")}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(t){function e(){t.call(this)}__extends(e,t);var a=(__define,e),i=a.prototype;return e.toString=function(){return"[class dragonBones.EgretSlot]"},i._onClear=function(){t.prototype._onClear.call(this),this.transformUpdateEnabled=!1,this._renderDisplay=null,this._colorFilter=null},i._onUpdateDisplay=function(){this._rawDisplay||(this._rawDisplay=new egret.Bitmap),this._renderDisplay=this._display||this._rawDisplay},i._initDisplay=function(t){},i._addDisplay=function(){var t=this._armature._display;t.addChild(this._renderDisplay)},i._replaceDisplay=function(t){var e=this._armature._display,a=t;e.addChild(this._renderDisplay),e.swapChildren(this._renderDisplay,a),e.removeChild(a)},i._removeDisplay=function(){this._renderDisplay.parent.removeChild(this._renderDisplay)},i._disposeDisplay=function(t){},i._updateVisible=function(){this._renderDisplay.visible=this._parent.visible},i._updateBlendMode=function(){if(this._blendMode<e.BLEND_MODE_LIST.length){var t=e.BLEND_MODE_LIST[this._blendMode];t&&(this._renderDisplay.blendMode=t)}},i._updateColor=function(){if(1!=this._colorTransform.redMultiplier||1!=this._colorTransform.greenMultiplier||1!=this._colorTransform.blueMultiplier||0!=this._colorTransform.redOffset||0!=this._colorTransform.greenOffset||0!=this._colorTransform.blueOffset||0!=this._colorTransform.alphaOffset){this._colorFilter||(this._colorFilter=new egret.ColorMatrixFilter);var t=this._colorFilter.matrix;t[0]=this._colorTransform.redMultiplier,t[6]=this._colorTransform.greenMultiplier,t[12]=this._colorTransform.blueMultiplier,t[18]=this._colorTransform.alphaMultiplier,t[4]=this._colorTransform.redOffset,t[9]=this._colorTransform.greenOffset,t[14]=this._colorTransform.blueOffset,t[19]=this._colorTransform.alphaOffset,this._colorFilter.matrix=t;var e=this._renderDisplay.filters;e||(e=[]),e.indexOf(this._colorFilter)<0&&e.push(this._colorFilter),this._renderDisplay.filters=e}else this._colorFilter&&(this._colorFilter=null,this._renderDisplay.filters=null),this._renderDisplay.$setAlpha(this._colorTransform.alphaMultiplier)},i._updateFilters=function(){},i._updateFrame=function(){var t=this._renderDisplay;if(this._display&&this._displayIndex>=0){var e=this._displayIndex<this._displayDataSet.displays.length?this._displayDataSet.displays[this._displayIndex]:null,a=this._displayIndex<this._replacedDisplayDataSet.length?this._replacedDisplayDataSet[this._displayIndex]:null,i=a||e,n=i.textureData;if(n){var r=n.parent.texture;!n.texture&&r&&(n.texture=new egret.Texture,n.texture._bitmapData=r._bitmapData,n.texture.$initData(n.region.x,n.region.y,Math.min(n.region.width,r.textureWidth-n.region.x),Math.min(n.region.height,r.textureHeight-n.region.y),0,0,Math.min(n.region.width,r.textureWidth-n.region.x),Math.min(n.region.height,r.textureHeight-n.region.y),r.textureWidth,r.textureHeight));var s=this._armature._replacedTexture||n.texture;if(this._meshData&&this._display==this._meshDisplay){var o=this._meshDisplay,l=o.$renderNode;l.uvs.length=0,l.vertices.length=0,l.indices.length=0;for(var h=0,_=this._meshData.vertices.length;_>h;++h)l.uvs[h]=this._meshData.uvs[h],l.vertices[h]=this._meshData.vertices[h];for(var h=0,_=this._meshData.vertexIndices.length;_>h;++h)l.indices[h]=this._meshData.vertexIndices[h];if(this._pivotX=0,this._pivotY=0,s&&o.$setBitmapData(s),o.$updateVertices(),o.$invalidateTransform(),this._meshData.skinned){var u=o.matrix;u.identity(),o.matrix=u}}else{var m=n.frame||n.region,f=m.width,c=m.height;n.rotated&&(f=m.height,c=m.width),this._pivotX=i.pivot.x,this._pivotY=i.pivot.y,i.isRelativePivot&&(this._pivotX=f*this._pivotX,this._pivotY=c*this._pivotY),n.frame&&(this._pivotX+=n.frame.x,this._pivotY+=n.frame.y),e&&e!=i&&(this._pivotX+=e.transform.x-i.transform.x,this._pivotY+=e.transform.y-i.transform.y),s&&t.$setBitmapData(s),t.$setAnchorOffsetX(this._pivotX),t.$setAnchorOffsetY(this._pivotY)}return void this._updateVisible()}}this._pivotX=0,this._pivotY=0,t.visible=!1,t.$setBitmapData(null),t.$setAnchorOffsetX(0),t.$setAnchorOffsetY(0),t.x=this.origin.x,t.y=this.origin.y},i._updateMesh=function(){var t=this._meshDisplay,e=t.$renderNode,a=this._ffdVertices.length>0;if(this._meshData.skinned){for(var i=0,n=0,r=this._meshData.vertices.length;r>i;i+=2){for(var s=i/2,o=this._meshData.boneIndices[s],l=this._meshData.boneVertices[s],h=this._meshData.weights[s],_=0,u=0,m=0,f=o.length;f>m;++m){var c=this._meshBones[o[m]],d=c.globalTransformMatrix,g=h[m],p=0,v=0;a?(p=l[2*m]+this._ffdVertices[n],v=l[2*m+1]+this._ffdVertices[n+1]):(p=l[2*m],v=l[2*m+1]),_+=(d.a*p+d.c*v+d.tx)*g,u+=(d.b*p+d.d*v+d.ty)*g,n+=2}e.vertices[i]=_,e.vertices[i+1]=u}t.$updateVertices(),t.$invalidateTransform()}else if(a){for(var T=this._meshData.vertices,i=0,r=this._meshData.vertices.length;r>i;i+=2){var _=T[i]+this._ffdVertices[i],u=T[i+1]+this._ffdVertices[i+1];e.vertices[i]=_,e.vertices[i+1]=u}t.$updateVertices(),t.$invalidateTransform()}},i._updateTransform=function(){this._renderDisplay.$setMatrix(this.globalTransformMatrix,this.transformUpdateEnabled)},e.BLEND_MODE_LIST=[egret.BlendMode.NORMAL,egret.BlendMode.ADD,null,null,null,egret.BlendMode.ERASE,null,null,null,null,null,null,null,null],e}(t.Slot);t.EgretSlot=e,egret.registerClass(e,"dragonBones.EgretSlot")}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(){function t(t,e,a,i,n,r){void 0===t&&(t=1),void 0===e&&(e=0),void 0===a&&(a=0),void 0===i&&(i=1),void 0===n&&(n=0),void 0===r&&(r=0),this.a=t,this.b=e,this.c=a,this.d=i,this.tx=n,this.ty=r}var e=(__define,t),a=e.prototype;return a.copyFrom=function(t){this.a=t.a,this.b=t.b,this.c=t.c,this.d=t.d,this.tx=t.tx,this.ty=t.ty},a.identity=function(){this.a=this.d=1,this.b=this.c=0,this.tx=this.ty=0},a.concat=function(t){var e=this.a,a=this.b,i=this.c,n=this.d,r=this.tx,s=this.ty,o=t.a,l=t.b,h=t.c,_=t.d,u=t.tx,m=t.ty;this.a=e*o+a*h,this.b=e*l+a*_,this.c=i*o+n*h,this.d=i*l+n*_,this.tx=o*r+h*s+u,this.ty=_*s+l*r+m},a.invert=function(){var t=this.a,e=this.b,a=this.c,i=this.d,n=this.tx,r=this.ty,s=t*i-e*a;this.a=i/s,this.b=-e/s,this.c=-a/s,this.d=t/s,this.tx=(a*r-i*n)/s,this.ty=-(t*r-e*n)/s},a.transformPoint=function(t,e,a,i){void 0===i&&(i=!1),a.x=this.a*t+this.c*e,a.y=this.b*t+this.d*e,i||(a.x+=this.tx,a.y+=this.ty)},t}();t.Matrix=e,egret.registerClass(e,"dragonBones.Matrix")}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(){function t(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.x=t,this.y=e}var e=(__define,t),a=e.prototype;return a.copyFrom=function(t){this.x=t.x,this.y=t.y},a.clear=function(){this.x=this.y=0},t}();t.Point=e,egret.registerClass(e,"dragonBones.Point")}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(){function t(t,e,a,i){void 0===t&&(t=0),void 0===e&&(e=0),void 0===a&&(a=0),void 0===i&&(i=0),this.x=t,this.y=e,this.width=a,this.height=i}var e=(__define,t),a=e.prototype;return a.copyFrom=function(t){this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height},a.clear=function(){this.x=this.y=0,this.width=this.height=0},t}();t.Rectangle=e,egret.registerClass(e,"dragonBones.Rectangle")}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(){function t(t,e,a,i,n,r){void 0===t&&(t=0),void 0===e&&(e=0),void 0===a&&(a=0),void 0===i&&(i=0),void 0===n&&(n=1),void 0===r&&(r=1),this.x=t,this.y=e,this.skewX=a,this.skewY=i,this.scaleX=n,this.scaleY=r}var e=__define,a=t,i=a.prototype;return t.normalizeRadian=function(t){return t=(t+Math.PI)%(2*Math.PI),t+=t>0?-Math.PI:Math.PI},i.toString=function(){return"[object dragonBones.Transform] x:"+this.x+" y:"+this.y+" skewX:"+180*this.skewX/Math.PI+" skewY:"+180*this.skewY/Math.PI+" scaleX:"+this.scaleX+" scaleY:"+this.scaleY},i.copyFrom=function(t){return this.x=t.x,this.y=t.y,this.skewX=t.skewX,this.skewY=t.skewY,this.scaleX=t.scaleX,this.scaleY=t.scaleY,this},i.clone=function(){var e=new t;return e.copyFrom(this),e},i.identity=function(){return this.x=this.y=this.skewX=this.skewY=0,this.scaleX=this.scaleY=1,this},i.add=function(t){return this.x+=t.x,this.y+=t.y,this.skewX+=t.skewX,this.skewY+=t.skewY,this.scaleX*=t.scaleX,this.scaleY*=t.scaleY,this},i.minus=function(e){return this.x-=e.x,this.y-=e.y,this.skewX=t.normalizeRadian(this.skewX-e.skewX),this.skewY=t.normalizeRadian(this.skewY-e.skewY),this.scaleX/=e.scaleX,this.scaleY/=e.scaleY,this},i.fromMatrix=function(t){var e=.25*Math.PI,a=this.scaleX,i=this.scaleY;return this.x=t.tx,this.y=t.ty,this.skewX=Math.atan(-t.c/t.d),this.skewY=Math.atan(t.b/t.a),this.skewX!=this.skewX&&(this.skewX=0),this.skewY!=this.skewY&&(this.skewY=0),this.scaleY=this.skewX>-e&&this.skewX<e?t.d/Math.cos(this.skewX):-t.c/Math.sin(this.skewX),this.scaleX=this.skewY>-e&&this.skewY<e?t.a/Math.cos(this.skewY):t.b/Math.sin(this.skewY),a>=0&&this.scaleX<0&&(this.scaleX=-this.scaleX,this.skewY=this.skewY-Math.PI),i>=0&&this.scaleY<0&&(this.scaleY=-this.scaleY,this.skewX=this.skewX-Math.PI),this},i.toMatrix=function(t){return t.a=this.scaleX*Math.cos(this.skewY),t.b=this.scaleX*Math.sin(this.skewY),t.c=-this.scaleY*Math.sin(this.skewX),t.d=this.scaleY*Math.cos(this.skewX),t.tx=this.x,t.ty=this.y,this},e(i,"rotation",function(){return this.skewY},function(t){var e=t-this.skewY;this.skewX+=e,this.skewY+=e}),t}();t.Transform=e,egret.registerClass(e,"dragonBones.Transform")}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(t){function e(){t.call(this),this.frames=[]}__extends(e,t);var a=(__define,e),i=a.prototype;return i._onClear=function(){if(this.scale=1,this.offset=0,this.frames.length){for(var t=null,e=0,a=this.frames.length;a>e;++e){var i=this.frames[e];t&&i!=t&&t.returnToPool(),t=i}this.frames.length=0}},e}(t.BaseObject);t.TimelineData=e,egret.registerClass(e,"dragonBones.TimelineData");var a=function(e){function a(){e.call(this),this.bone=null,this.originTransform=new t.Transform,this.cachedFrames=[]}__extends(a,e);var i=(__define,a),n=i.prototype;return a.cacheFrame=function(e,a,i){var n=e[a]=new t.Matrix;return n.copyFrom(i),n},a.toString=function(){return"[class dragonBones.BoneTimelineData]"},n._onClear=function(){e.prototype._onClear.call(this),this.bone=null,this.originTransform.identity(),this.cachedFrames.length&&(this.cachedFrames.length=0)},n.cacheFrames=function(t){this.cachedFrames.length=0,this.cachedFrames.length=t},a}(e);t.BoneTimelineData=a,egret.registerClass(a,"dragonBones.BoneTimelineData");var i=function(e){function a(){e.call(this),this.slot=null,this.cachedFrames=[]}__extends(a,e);var i=(__define,a),n=i.prototype;return a.cacheFrame=function(e,a,i){var n=e[a]=new t.Matrix;return n.copyFrom(i),n},a.toString=function(){return"[class dragonBones.SlotTimelineData]"},n._onClear=function(){e.prototype._onClear.call(this),this.slot=null,this.cachedFrames.length&&(this.cachedFrames.length=0)},n.cacheFrames=function(t){this.cachedFrames.length=0,this.cachedFrames.length=t},a}(e);t.SlotTimelineData=i,egret.registerClass(i,"dragonBones.SlotTimelineData");var n=function(t){function e(){t.call(this),this.displayIndex=0,this.skin=null,this.slot=null}__extends(e,t);var a=(__define,e),i=a.prototype;return e.toString=function(){return"[class dragonBones.FFDTimelineData]"},i._onClear=function(){t.prototype._onClear.call(this),this.displayIndex=0,this.skin=null,this.slot=null},e}(e);t.FFDTimelineData=n,egret.registerClass(n,"dragonBones.FFDTimelineData")}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(t){function e(){t.call(this),this.boneTimelines={},this.slotTimelines={},this.ffdTimelines={},this.cachedFrames=[]}__extends(e,t);var a=(__define,e),i=a.prototype;return e.toString=function(){return"[class dragonBones.AnimationData]"},i._onClear=function(){t.prototype._onClear.call(this),this.hasAsynchronyTimeline=!1,this.cacheTimeToFrameScale=0,this.position=0,this.duration=0,this.playTimes=0,this.fadeInTime=0,this.name=null,this.animation=null;for(var e in this.boneTimelines)this.boneTimelines[e].returnToPool(),delete this.boneTimelines[e];for(var e in this.slotTimelines)this.slotTimelines[e].returnToPool(),delete this.slotTimelines[e];for(var e in this.ffdTimelines){for(var a in this.ffdTimelines[e])for(var i in this.ffdTimelines[e][a])this.ffdTimelines[e][a][i].returnToPool();delete this.ffdTimelines[e]}this.cachedFrames.length&&(this.cachedFrames.length=0)},i.cacheFrames=function(t){if(!this.animation){var e=Math.max(Math.floor((this.frameCount+1)*this.scale*t),1);this.cacheTimeToFrameScale=e/(this.duration+1e-6),this.cachedFrames.length=0,this.cachedFrames.length=e;for(var a in this.boneTimelines)this.boneTimelines[a].cacheFrames(e);for(var a in this.slotTimelines)this.slotTimelines[a].cacheFrames(e)}},i.addBoneTimeline=function(t){if(!t||!t.bone||this.boneTimelines[t.bone.name])throw new Error;this.boneTimelines[t.bone.name]=t},i.addSlotTimeline=function(t){if(!t||!t.slot||this.slotTimelines[t.slot.name])throw new Error;this.slotTimelines[t.slot.name]=t},i.addFFDTimeline=function(t){if(!(t&&t.skin&&t.slot))throw new Error;var e=this.ffdTimelines[t.skin.name]=this.ffdTimelines[t.skin.name]||{},a=e[t.slot.slot.name]=e[t.slot.slot.name]||{};if(a[t.displayIndex])throw new Error;a[t.displayIndex]=t},i.getBoneTimeline=function(t){return this.boneTimelines[t]},i.getSlotTimeline=function(t){return this.slotTimelines[t]},i.getFFDTimeline=function(t,e,a){var i=this.ffdTimelines[t];if(i){var n=i[e];if(n)return n[a]}return null},e}(t.TimelineData);t.AnimationData=e,egret.registerClass(e,"dragonBones.AnimationData")}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(e){function a(){e.call(this),this.aabb=new t.Rectangle,this.bones={},this.slots={},this.skins={},this.animations={},this.actions=[],this._sortedBones=[],this._sortedSlots=[],this._bonesChildren={}}__extends(a,e);var i=__define,n=a,r=n.prototype;return a._onSortSlots=function(t,e){return t.zOrder>e.zOrder?1:-1},a.toString=function(){return"[class dragonBones.ArmatureData]"},r._onClear=function(){this.frameRate=0,this.cacheFrameRate=0,this.type=0,this.name=null,this.parent=null,this.userData=null,this.aabb.clear();for(var t in this.bones)this.bones[t].returnToPool(),delete this.bones[t];for(var t in this.slots)this.slots[t].returnToPool(),delete this.slots[t];for(var t in this.skins)this.skins[t].returnToPool(),delete this.skins[t];for(var t in this.animations)this.animations[t].returnToPool(),delete this.animations[t];if(this.actions.length){for(var t=0,e=this.actions.length;e>t;++t)this.actions[t].returnToPool();this.actions.length=0}this._boneDirty=!1,this._slotDirty=!1,this._defaultSkin=null,this._defaultAnimation=null,this._sortedBones.length&&(this._sortedBones.length=0),this._sortedSlots.length&&(this._sortedSlots.length=0);for(var t in this._bonesChildren)delete this._bonesChildren[t]},r._sortBones=function(){var t=this._sortedBones.length;if(t){var e=this._sortedBones.concat(),a=0,i=0;for(this._sortedBones.length=0;t>i;){var n=e[a++];a>=t&&(a=0),this._sortedBones.indexOf(n)>=0||n.parent&&this._sortedBones.indexOf(n.parent)<0||n.ik&&this._sortedBones.indexOf(n.ik)<0||(n.ik&&n.chain>0&&n.chainIndex==n.chain?this._sortedBones.splice(this._sortedBones.indexOf(n.parent)+1,0,n):this._sortedBones.push(n),i++)}}},r._sortSlots=function(){this._sortedSlots.sort(a._onSortSlots)},r.cacheFrames=function(t){if(this.cacheFrameRate!=t){this.cacheFrameRate=t;var e=this.cacheFrameRate/this.frameRate;for(var a in this.animations)this.animations[a].cacheFrames(e)}},r.addBone=function(t,e){if(!t||!t.name||this.bones[t.name])throw new Error;if(e){var a=this.getBone(e);a?t.parent=a:(this._bonesChildren[e]=this._bonesChildren[e]||[]).push(t)}var i=this._bonesChildren[t.name];if(i){for(var n=0,r=i.length;r>n;++n)i[n].parent=t;delete this._bonesChildren[t.name]}this.bones[t.name]=t,this._sortedBones.push(t),this._boneDirty=!0},r.addSlot=function(t){if(!t||!t.name||this.slots[t.name])throw new Error;this.slots[t.name]=t,this._sortedSlots.push(t),this._slotDirty=!0},r.addSkin=function(t){if(!t||!t.name||this.skins[t.name])throw new Error;this.skins[t.name]=t,this._defaultSkin||(this._defaultSkin=t)},r.addAnimation=function(t){if(!t||!t.name||this.animations[t.name])throw new Error;this.animations[t.name]=t,this._defaultAnimation||(this._defaultAnimation=t)},r.getBone=function(t){return this.bones[t]},r.getSlot=function(t){return this.slots[t]},r.getSkin=function(t){return t?this.skins[t]:this._defaultSkin},r.getAnimation=function(t){return t?this.animations[t]:this._defaultAnimation},i(r,"sortedBones",function(){return this._boneDirty&&(this._boneDirty=!1,this._sortBones()),this._sortedBones}),i(r,"sortedSlots",function(){return this._slotDirty&&(this._slotDirty=!1,this._sortSlots()),this._sortedSlots}),i(r,"defaultSkin",function(){return this._defaultSkin}),i(r,"defaultAnimation",function(){return this._defaultAnimation}),a}(t.BaseObject);t.ArmatureData=e,egret.registerClass(e,"dragonBones.ArmatureData");var a=function(e){function a(){e.call(this),this.transform=new t.Transform}__extends(a,e);var i=(__define,a),n=i.prototype;return a.toString=function(){return"[class dragonBones.BoneData]"},n._onClear=function(){this.inheritTranslation=!1,this.inheritRotation=!1,this.inheritScale=!1,this.bendPositive=!1,this.chain=0,this.chainIndex=0,this.weight=0,this.length=0,this.name=null,this.parent=null,this.ik=null,this.transform.identity()},a}(t.BaseObject);t.BoneData=a,egret.registerClass(a,"dragonBones.BoneData");var i=function(e){function a(){e.call(this),this.actions=[]}__extends(a,e);var i=(__define,a),n=i.prototype;return a.generateColor=function(){return new t.ColorTransform},a.toString=function(){return"[class dragonBones.SlotData]"},n._onClear=function(){if(this.displayIndex=0,this.zOrder=0,this.blendMode=0,this.name=null,this.parent=null,this.color=null,this.actions.length){for(var t=0,e=this.actions.length;e>t;++t)this.actions[t].returnToPool();this.actions.length=0}},a.DEFAULT_COLOR=new t.ColorTransform,a}(t.BaseObject);t.SlotData=i,egret.registerClass(i,"dragonBones.SlotData");var n=function(t){function e(){t.call(this),this.name=null,this.slots={}}__extends(e,t);var a=(__define,e),i=a.prototype;return e.toString=function(){return"[class dragonBones.SkinData]"},i._onClear=function(){this.name=null;for(var t in this.slots)this.slots[t].returnToPool(),delete this.slots[t]},i.addSlot=function(t){if(!t||!t.slot||this.slots[t.slot.name])throw new Error;this.slots[t.slot.name]=t},i.getSlot=function(t){return this.slots[t]},e}(t.BaseObject);t.SkinData=n,egret.registerClass(n,"dragonBones.SkinData");var r=function(t){function e(){t.call(this),this.displays=[]}__extends(e,t);var a=(__define,e),i=a.prototype;return e.toString=function(){return"[class dragonBones.SlotDisplayDataSet]"},i._onClear=function(){if(this.slot=null,this.displays.length){for(var t=0,e=this.displays.length;e>t;++t)this.displays[t].returnToPool();this.displays.length=0}},e}(t.BaseObject);t.SlotDisplayDataSet=r,egret.registerClass(r,"dragonBones.SlotDisplayDataSet");var s=function(e){function a(){e.call(this),this.pivot=new t.Point,this.transform=new t.Transform}__extends(a,e);var i=(__define,a),n=i.prototype;return a.toString=function(){return"[class dragonBones.DisplayData]"},n._onClear=function(){this.isRelativePivot=!1,this.type=0,this.name=null,this.textureData=null,this.armatureData=null,this.mesh&&(this.mesh.returnToPool(),this.mesh=null),this.pivot.clear(),this.transform.identity()},a}(t.BaseObject);t.DisplayData=s,egret.registerClass(s,"dragonBones.DisplayData");var o=function(e){function a(){e.call(this),this.slotPose=new t.Matrix,this.uvs=[],this.vertices=[],this.vertexIndices=[],this.boneIndices=[],this.weights=[],this.boneVertices=[],this.bones=[],this.inverseBindPose=[]}__extends(a,e);var i=(__define,a),n=i.prototype;return a.toString=function(){return"[class dragonBones.MeshData]"},n._onClear=function(){this.skinned=!1,this.slotPose.identity(),this.uvs.length&&(this.uvs.length=0),this.vertices.length&&(this.vertices.length=0),this.vertexIndices.length&&(this.vertexIndices.length=0),this.boneIndices.length&&(this.boneIndices.length=0),this.weights.length&&(this.weights.length=0),this.boneVertices.length&&(this.boneVertices.length=0),this.bones.length&&(this.bones.length=0),this.inverseBindPose.length&&(this.inverseBindPose.length=0)
},a}(t.BaseObject);t.MeshData=o,egret.registerClass(o,"dragonBones.MeshData")}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(t){function e(){t.call(this),this.armatures={},this._armatureNames=[]}__extends(e,t);var a=__define,i=e,n=i.prototype;return e.toString=function(){return"[class dragonBones.DragonBonesData]"},n._onClear=function(){this.autoSearch=!1,this.frameRate=0,this.name=null,this.userData=null;for(var t in this.armatures)this.armatures[t].returnToPool(),delete this.armatures[t];this._armatureNames.length&&(this._armatureNames.length=0)},n.getArmature=function(t){return this.armatures[t]},n.addArmature=function(t){if(!t||!t.name||this.armatures[t.name])throw new Error;this.armatures[t.name]=t,this._armatureNames.push(t.name),t.parent=this},a(n,"armatureNames",function(){return this._armatureNames}),n.dispose=function(){this.returnToPool()},e}(t.BaseObject);t.DragonBonesData=e,egret.registerClass(e,"dragonBones.DragonBonesData")}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(t){function e(){t.call(this)}__extends(e,t);var a=(__define,e),i=a.prototype;return e.toString=function(){return"[class dragonBones.ActionData]"},i._onClear=function(){this.type=0,this.data=null,this.bone=null,this.slot=null},e}(t.BaseObject);t.ActionData=e,egret.registerClass(e,"dragonBones.ActionData");var a=function(t){function e(){t.call(this)}__extends(e,t);var a=(__define,e),i=a.prototype;return e.toString=function(){return"[class dragonBones.EventData]"},i._onClear=function(){this.type=10,this.name=null,this.data=null,this.bone=null,this.slot=null},e}(t.BaseObject);t.EventData=a,egret.registerClass(a,"dragonBones.EventData");var i=function(t){function e(){t.call(this)}__extends(e,t);var a=(__define,e),i=a.prototype;return i._onClear=function(){this.position=0,this.duration=0,this.prev=null,this.next=null},e}(t.BaseObject);t.FrameData=i,egret.registerClass(i,"dragonBones.FrameData");var n=function(t){function e(){t.call(this)}__extends(e,t);var a=(__define,e),i=a.prototype;return e.samplingCurve=function(t,e){if(0==t.length||0==e)return null;var a=e+2,i=1/a,n=new Array(2*(a-1));t=t.concat(),t.unshift(0,0),t.push(1,1);for(var r=0,s=0;a-1>s;++s){for(var o=i*(s+1);t[r+6]<o;)r+=6;var l=t[r],h=t[r+6],_=(o-l)/(h-l),u=1-_,m=u*u,f=_*_,c=u*m,d=3*_*m,g=3*u*f,p=_*f;n[2*s]=c*l+d*t[r+2]+g*t[r+4]+p*h,n[2*s+1]=c*t[r+1]+d*t[r+3]+g*t[r+5]+p*t[r+7]}return n},i._onClear=function(){t.prototype._onClear.call(this),this.tweenEasing=0,this.curve=null},e}(i);t.TweenFrameData=n,egret.registerClass(n,"dragonBones.TweenFrameData");var r=function(t){function e(){t.call(this),this.actions=[],this.events=[]}__extends(e,t);var a=(__define,e),i=a.prototype;return e.toString=function(){return"[class dragonBones.AnimationFrameData]"},i._onClear=function(){if(t.prototype._onClear.call(this),this.actions.length){for(var e=0,a=this.actions.length;a>e;++e)this.actions[e].returnToPool();this.actions.length=0}if(this.events.length){for(var e=0,a=this.events.length;a>e;++e)this.events[e].returnToPool();this.events.length=0}},e}(i);t.AnimationFrameData=r,egret.registerClass(r,"dragonBones.AnimationFrameData");var s=function(e){function a(){e.call(this),this.transform=new t.Transform}__extends(a,e);var i=(__define,a),n=i.prototype;return a.toString=function(){return"[class dragonBones.BoneFrameData]"},n._onClear=function(){e.prototype._onClear.call(this),this.tweenScale=!1,this.tweenRotate=0,this.transform.identity()},a}(n);t.BoneFrameData=s,egret.registerClass(s,"dragonBones.BoneFrameData");var o=function(e){function a(){e.call(this)}__extends(a,e);var i=(__define,a),n=i.prototype;return a.generateColor=function(){return new t.ColorTransform},a.toString=function(){return"[class dragonBones.SlotFrameData]"},n._onClear=function(){e.prototype._onClear.call(this),this.displayIndex=0,this.zOrder=0,this.color=null},a.DEFAULT_COLOR=new t.ColorTransform,a}(n);t.SlotFrameData=o,egret.registerClass(o,"dragonBones.SlotFrameData");var l=function(t){function e(){t.call(this),this.tweens=[],this.keys=[]}__extends(e,t);var a=(__define,e),i=a.prototype;return e.toString=function(){return"[class dragonBones.ExtensionFrameData]"},i._onClear=function(){t.prototype._onClear.call(this),this.type=0,this.tweens.length&&(this.tweens.length=0),this.keys.length&&(this.keys.length=0)},e}(n);t.ExtensionFrameData=l,egret.registerClass(l,"dragonBones.ExtensionFrameData")}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(){function e(){this._data=null,this._armature=null,this._skin=null,this._slotDisplayDataSet=null,this._mesh=null,this._animation=null,this._timeline=null,this._isOldData=!1,this._isGlobalTransform=!1,this._isAutoTween=!1,this._animationTweenEasing=0,this._timelinePivot=new t.Point,this._armatureScale=1,this._helpPoint=new t.Point,this._helpTransformA=new t.Transform,this._helpTransformB=new t.Transform,this._helpMatrix=new t.Matrix,this._rawBones=[]}var a=(__define,e),i=a.prototype;return e._getArmatureType=function(t){switch(t.toLowerCase()){case"stage":return 0;case"armature":return 0;case"movieclip":return 1;default:return 0}},e._getDisplayType=function(t){switch(t.toLowerCase()){case"image":return 0;case"armature":return 1;case"mesh":return 2;default:return 0}},e._getBlendMode=function(t){switch(t.toLowerCase()){case"normal":return 0;case"add":return 1;case"alpha":return 2;case"darken":return 3;case"difference":return 4;case"erase":return 5;case"hardlight":return 6;case"invert":return 7;case"layer":return 8;case"lighten":return 9;case"multiply":return 10;case"overlay":return 11;case"screen":return 12;case"subtract":return 13;default:return 0}},e._getActionType=function(t){switch(t.toLowerCase()){case"play":return 0;case"stop":return 1;case"gotoandplay":return 2;case"gotoandstop":return 3;case"fadein":return 4;case"fadeout":return 5;default:return 4}},i._getTimelineFrameMatrix=function(e,a,i,n){var r=Math.floor(i*e.frameCount/e.duration);if(1==a.frames.length||r>=a.frames.length)n.copyFrom(a.frames[0].transform);else{var s=a.frames[r],o=0;s.tweenEasing!=t.DragonBones.NO_TWEEN?(o=(i-s.position)/s.duration,0!=s.tweenEasing&&(o=t.TweenTimelineState._getEasingValue(o,s.tweenEasing))):s.curve&&(o=(i-s.position)/s.duration,o=t.TweenTimelineState._getCurveEasingValue(o,s.curve));var l=s.next;n.x=l.transform.x-s.transform.x,n.y=l.transform.y-s.transform.y,n.skewX=t.Transform.normalizeRadian(l.transform.skewX-s.transform.skewX),n.skewY=t.Transform.normalizeRadian(l.transform.skewY-s.transform.skewY),n.scaleX=l.transform.scaleX-s.transform.scaleX,n.scaleY=l.transform.scaleY-s.transform.scaleY,n.x=s.transform.x+n.x*o,n.y=s.transform.y+n.y*o,n.skewX=s.transform.skewX+n.skewX*o,n.skewY=s.transform.skewY+n.skewY*o,n.scaleX=s.transform.scaleX+n.scaleX*o,n.scaleY=s.transform.scaleY+n.scaleY*o}n.add(a.originTransform)},i._globalToLocal=function(t){for(var e=[],a=t.sortedBones.concat().reverse(),i=0,n=a.length;n>i;++i){var r=a[i];r.parent&&(r.parent.transform.toMatrix(this._helpMatrix),this._helpMatrix.invert(),this._helpMatrix.transformPoint(r.transform.x,r.transform.y,r.transform),r.transform.rotation-=r.parent.transform.rotation);for(var s in t.animations){var o=t.animations[s],l=o.getBoneTimeline(r.name);if(l){var h=r.parent?o.getBoneTimeline(r.parent.name):null;this._helpTransformB.copyFrom(l.originTransform),e.length=0;for(var _=0,u=l.frames.length;u>_;++_){var m=l.frames[_];e.indexOf(m)>=0||(e.push(m),h?(this._getTimelineFrameMatrix(o,h,m.position,this._helpTransformA),m.transform.add(this._helpTransformB),this._helpTransformA.toMatrix(this._helpMatrix),this._helpMatrix.invert(),this._helpMatrix.transformPoint(m.transform.x,m.transform.y,m.transform),m.transform.rotation-=this._helpTransformA.rotation):m.transform.add(this._helpTransformB),m.transform.minus(r.transform),0==_?(l.originTransform.copyFrom(m.transform),m.transform.identity()):m.transform.minus(l.originTransform))}}}}},i._mergeFrameToAnimationTimeline=function(e,a,i){var n=Math.floor(e.position*this._armature.frameRate),r=this._animation.frames;if(0==r.length){var s=t.BaseObject.borrowObject(t.AnimationFrameData);if(s.position=0,this._animation.frameCount>1){r.length=this._animation.frameCount+1;var o=t.BaseObject.borrowObject(t.AnimationFrameData);o.position=this._animation.frameCount/this._armature.frameRate,r[0]=s,r[this._animation.frameCount]=o}}var l=null,h=r[n];if(!h||0!=n&&r[n-1]!=h.prev){l=t.BaseObject.borrowObject(t.AnimationFrameData),l.position=n/this._armature.frameRate,r[n]=l;for(var _=n+1,u=r.length;u>_;++_)h&&r[_]==h&&(r[_]=null)}else l=h;if(a)for(var _=0,u=a.length;u>_;++_)l.actions.push(a[_]);if(i)for(var _=0,u=i.length;u>_;++_)l.events.push(i[_]);for(var m=null,f=null,_=0,u=r.length;u>_;++_){var c=r[_];c&&f!=c?(f=c,m&&(f.prev=m,m.next=f,m.duration=f.position-m.position),m=f):r[_]=m}f.duration=this._animation.duration-f.position,f=r[0],m.next=f,f.prev=m},e.parseDragonBonesData=function(e){return t.ObjectDataParser.getInstance().parseDragonBonesData(e)},e.parseTextureAtlasData=function(a,i){void 0===i&&(i=1);for(var n={},r=a[e.SUB_TEXTURE],s=0,o=r.length;o>s;s++){var l=r[s],h=l[e.NAME],_=new t.Rectangle,u=null;_.x=l[e.X]/i,_.y=l[e.Y]/i,_.width=l[e.WIDTH]/i,_.height=l[e.HEIGHT]/i,e.FRAME_WIDTH in l&&(u=new t.Rectangle,u.x=l[e.FRAME_X]/i,u.y=l[e.FRAME_Y]/i,u.width=l[e.FRAME_WIDTH]/i,u.height=l[e.FRAME_HEIGHT]/i),n[h]={region:_,frame:u,rotated:!1}}return n},e.DATA_VERSION_2_3="2.3",e.DATA_VERSION_3_0="3.0",e.DATA_VERSION_4_0="4.0",e.DATA_VERSION="4.5",e.TEXTURE_ATLAS="TextureAtlas",e.SUB_TEXTURE="SubTexture",e.FORMAT="format",e.IMAGE_PATH="imagePath",e.WIDTH="width",e.HEIGHT="height",e.ROTATED="rotated",e.FRAME_X="frameX",e.FRAME_Y="frameY",e.FRAME_WIDTH="frameWidth",e.FRAME_HEIGHT="frameHeight",e.DRADON_BONES="dragonBones",e.ARMATURE="armature",e.BONE="bone",e.IK="ik",e.SLOT="slot",e.SKIN="skin",e.DISPLAY="display",e.ANIMATION="animation",e.FFD="ffd",e.FRAME="frame",e.PIVOT="pivot",e.TRANSFORM="transform",e.AABB="aabb",e.COLOR="color",e.FILTER="filter",e.VERSION="version",e.IS_GLOBAL="isGlobal",e.FRAME_RATE="frameRate",e.TYPE="type",e.NAME="name",e.PARENT="parent",e.LENGTH="length",e.DATA="data",e.DISPLAY_INDEX="displayIndex",e.Z_ORDER="z",e.BLEND_MODE="blendMode",e.INHERIT_TRANSLATION="inheritTranslation",e.INHERIT_ROTATION="inheritRotation",e.INHERIT_SCALE="inheritScale",e.TARGET="target",e.BEND_POSITIVE="bendPositive",e.CHAIN="chain",e.WEIGHT="weight",e.FADE_IN_TIME="fadeInTime",e.PLAY_TIMES="playTimes",e.SCALE="scale",e.OFFSET="offset",e.POSITION="position",e.DURATION="duration",e.TWEEN_EASING="tweenEasing",e.TWEEN_ROTATE="tweenRotate",e.TWEEN_SCALE="tweenScale",e.CURVE="curve",e.EVENT="event",e.SOUND="sound",e.ACTION="action",e.ACTIONS="actions",e.DEFAULT_ACTIONS="defaultActions",e.X="x",e.Y="y",e.SKEW_X="skX",e.SKEW_Y="skY",e.SCALE_X="scX",e.SCALE_Y="scY",e.ALPHA_OFFSET="aO",e.RED_OFFSET="rO",e.GREEN_OFFSET="gO",e.BLUE_OFFSET="bO",e.ALPHA_MULTIPLIER="aM",e.RED_MULTIPLIER="rM",e.GREEN_MULTIPLIER="gM",e.BLUE_MULTIPLIER="bM",e.UVS="uvs",e.VERTICES="vertices",e.TRIANGLES="triangles",e.WEIGHTS="weights",e.SLOT_POSE="slotPose",e.BONE_POSE="bonePose",e.TWEEN="tween",e.KEY="key",e.COLOR_TRANSFORM="colorTransform",e.TIMELINE="timeline",e.PIVOT_X="pX",e.PIVOT_Y="pY",e.LOOP="loop",e.AUTO_TWEEN="autoTween",e.HIDE="hide",e.RECTANGLE="rectangle",e.ELLIPSE="ellipse",e}();t.DataParser=e,egret.registerClass(e,"dragonBones.DataParser")}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(e){function a(){e.call(this)}__extends(a,e);var i=(__define,a),n=i.prototype;return a._getBoolean=function(t,e,a){if(e in t){var i=t[e],n=typeof i;if("boolean"==n)return i;if("string"!=n)return!!i;switch(i){case"0":case"NaN":case"":case"false":case"null":case"undefined":return!1;default:return!0}}return a},a._getNumber=function(t,e,a){if(e in t){var i=t[e];return null==i||"NaN"==i?a:+i||0}return a},a._getString=function(t,e,a){return e in t?String(t[e]):a},a._getParameter=function(t,e,a){return t&&t.length>e?t[e]:a},n._parseArmature=function(e){var i=t.BaseObject.borrowObject(t.ArmatureData);if(i.name=a._getString(e,a.NAME,null),i.frameRate=a._getNumber(e,a.FRAME_RATE,this._data.frameRate)||this._data.frameRate,a.TYPE in e&&"string"==typeof e[a.TYPE]?i.type=a._getArmatureType(e[a.TYPE]):i.type=a._getNumber(e,a.TYPE,0),this._armature=i,this._rawBones.length=0,a.AABB in e){var n=e[a.AABB];i.aabb.x=a._getNumber(n,a.X,0),i.aabb.y=a._getNumber(n,a.Y,0),i.aabb.width=a._getNumber(n,a.WIDTH,0),i.aabb.height=a._getNumber(n,a.HEIGHT,0)}if(a.BONE in e)for(var r=e[a.BONE],s=0,o=r.length;o>s;++s){var l=r[s],h=this._parseBone(l);i.addBone(h,a._getString(l,a.PARENT,null)),this._rawBones.push(h)}if(a.IK in e)for(var _=e[a.IK],s=0,o=_.length;o>s;++s)this._parseIK(_[s]);if(a.SLOT in e)for(var u=e[a.SLOT],m=0,s=0,o=u.length;o>s;++s)i.addSlot(this._parseSlot(u[s],m++));if(a.SKIN in e)for(var f=e[a.SKIN],s=0,o=f.length;o>s;++s)i.addSkin(this._parseSkin(f[s]));if(a.ANIMATION in e)for(var c=e[a.ANIMATION],s=0,o=c.length;o>s;++s)i.addAnimation(this._parseAnimation(c[s]));return(a.ACTIONS in e||a.DEFAULT_ACTIONS in e)&&this._parseActionData(e,i.actions,null,null),this._isOldData&&this._isGlobalTransform&&this._globalToLocal(i),this._armature=null,this._rawBones.length=0,i},n._parseBone=function(e){var i=t.BaseObject.borrowObject(t.BoneData);return i.name=a._getString(e,a.NAME,null),i.inheritTranslation=a._getBoolean(e,a.INHERIT_TRANSLATION,!0),i.inheritRotation=a._getBoolean(e,a.INHERIT_ROTATION,!0),i.inheritScale=a._getBoolean(e,a.INHERIT_SCALE,!0),i.length=a._getNumber(e,a.LENGTH,0)*this._armatureScale,a.TRANSFORM in e&&this._parseTransform(e[a.TRANSFORM],i.transform),this._isOldData&&(i.inheritRotation=!0,i.inheritScale=!1),i},n._parseIK=function(t){var e=this._armature.getBone(a._getString(t,a.BONE in t?a.BONE:a.NAME,null));e&&(e.ik=this._armature.getBone(a._getString(t,a.TARGET,null)),e.bendPositive=a._getBoolean(t,a.BEND_POSITIVE,!0),e.chain=a._getNumber(t,a.CHAIN,0),e.weight=a._getNumber(t,a.WEIGHT,1),e.chain>0&&e.parent&&!e.parent.ik?(e.parent.ik=e.ik,e.parent.chainIndex=0,e.parent.chain=0,e.chainIndex=1):(e.chain=0,e.chainIndex=0))},n._parseSlot=function(e,i){var n=t.BaseObject.borrowObject(t.SlotData);return n.name=a._getString(e,a.NAME,null),n.parent=this._armature.getBone(a._getString(e,a.PARENT,null)),n.displayIndex=a._getNumber(e,a.DISPLAY_INDEX,0),n.zOrder=a._getNumber(e,a.Z_ORDER,i),a.COLOR in e?(n.color=t.SlotData.generateColor(),this._parseColorTransform(e[a.COLOR],n.color)):n.color=t.SlotData.DEFAULT_COLOR,a.BLEND_MODE in e&&"string"==typeof e[a.BLEND_MODE]?n.blendMode=a._getBlendMode(e[a.BLEND_MODE]):n.blendMode=a._getNumber(e,a.BLEND_MODE,0),(a.ACTIONS in e||a.DEFAULT_ACTIONS in e)&&this._parseActionData(e,n.actions,null,null),this._isOldData&&(a.COLOR_TRANSFORM in e?(n.color=t.SlotData.generateColor(),this._parseColorTransform(e[a.COLOR_TRANSFORM],n.color)):n.color=t.SlotData.DEFAULT_COLOR),n},n._parseSkin=function(e){var i=t.BaseObject.borrowObject(t.SkinData);if(i.name=a._getString(e,a.NAME,"__default")||"__default",a.SLOT in e){this._skin=i;for(var n=e[a.SLOT],r=0,s=0,o=n.length;o>s;++s)this._isOldData&&this._armature.addSlot(this._parseSlot(n[s],r++)),i.addSlot(this._parseSlotDisplaySet(n[s]));this._skin=null}return i},n._parseSlotDisplaySet=function(e){var i=t.BaseObject.borrowObject(t.SlotDisplayDataSet);if(i.slot=this._armature.getSlot(a._getString(e,a.NAME,null)),a.DISPLAY in e){var n=e[a.DISPLAY],r=i.displays;this._slotDisplayDataSet=i;for(var s=0,o=n.length;o>s;++s)r.push(this._parseDisplay(n[s]));this._slotDisplayDataSet=null}return i},n._parseDisplay=function(e){var i=t.BaseObject.borrowObject(t.DisplayData);if(i.name=a._getString(e,a.NAME,null),a.TYPE in e&&"string"==typeof e[a.TYPE]?i.type=a._getDisplayType(e[a.TYPE]):i.type=a._getNumber(e,a.TYPE,0),i.isRelativePivot=!0,a.PIVOT in e){var n=e[a.PIVOT];i.pivot.x=a._getNumber(n,a.X,0),i.pivot.y=a._getNumber(n,a.Y,0)}else if(this._isOldData){var r=e[a.TRANSFORM];i.isRelativePivot=!1,i.pivot.x=a._getNumber(r,a.PIVOT_X,0)*this._armatureScale,i.pivot.y=a._getNumber(r,a.PIVOT_Y,0)*this._armatureScale}else i.pivot.x=.5,i.pivot.y=.5;switch(a.TRANSFORM in e&&this._parseTransform(e[a.TRANSFORM],i.transform),i.type){case 0:break;case 1:break;case 2:i.mesh=this._parseMesh(e)}return i},n._parseMesh=function(e){var i=t.BaseObject.borrowObject(t.MeshData),n=e[a.VERTICES],r=e[a.UVS],s=e[a.TRIANGLES],o=Math.floor(n.length/2),l=Math.floor(s.length/3),h=new Array(this._armature.sortedBones.length);if(i.skinned=a.WEIGHTS in e&&e[a.WEIGHTS].length>0,i.uvs.length=2*o,i.vertices.length=2*o,i.vertexIndices.length=3*l,i.skinned){if(i.boneIndices.length=o,i.weights.length=o,i.boneVertices.length=o,a.SLOT_POSE in e){var _=e[a.SLOT_POSE];i.slotPose.a=_[0],i.slotPose.b=_[1],i.slotPose.c=_[2],i.slotPose.d=_[3],i.slotPose.tx=_[4],i.slotPose.ty=_[5]}if(a.BONE_POSE in e)for(var u=e[a.BONE_POSE],m=0,f=u.length;f>m;m+=7){var c=u[m],d=h[c]=new t.Matrix;d.a=u[m+1],d.b=u[m+2],d.c=u[m+3],d.d=u[m+4],d.tx=u[m+5],d.ty=u[m+6],d.invert()}}for(var m=0,g=0,f=n.length;f>m;m+=2){var p=m+1,v=m/2,T=i.vertices[m]=n[m]*this._armatureScale,y=i.vertices[p]=n[p]*this._armatureScale;if(i.uvs[m]=r[m],i.uvs[p]=r[p],i.skinned){var D=e[a.WEIGHTS],b=D[g],E=i.boneIndices[v]=new Array(b),S=i.weights[v]=new Array(b),O=i.boneVertices[v]=new Array(2*b);i.slotPose.transformPoint(T,y,this._helpPoint),T=i.vertices[m]=this._helpPoint.x,y=i.vertices[p]=this._helpPoint.y;for(var A=0;b>A;++A){var B=g+1+2*A,c=D[B],x=this._rawBones[c],w=i.bones.indexOf(x);0>w&&(w=i.bones.length,i.bones[w]=x,i.inverseBindPose[w]=h[c]),i.inverseBindPose[w].transformPoint(T,y,this._helpPoint),E[A]=w,S[A]=D[B+1],O[2*A]=this._helpPoint.x,O[2*A+1]=this._helpPoint.y}g+=2*b+1}}for(var m=0,f=s.length;f>m;++m)i.vertexIndices[m]=s[m];return i},n._parseAnimation=function(e){var i=t.BaseObject.borrowObject(t.AnimationData);i.name=a._getString(e,a.NAME,"__default")||"__default",i.frameCount=Math.max(a._getNumber(e,a.DURATION,1),1),i.position=a._getNumber(e,a.POSITION,0)/this._armature.frameRate,i.duration=i.frameCount/this._armature.frameRate,i.playTimes=a._getNumber(e,a.PLAY_TIMES,1),i.fadeInTime=a._getNumber(e,a.FADE_IN_TIME,0),this._animation=i;var n=a._getString(e,a.ANIMATION,null);if(n)return i.animation=this._armature.getAnimation(n),!i.animation,i;if(this._parseTimeline(e,i,this._parseAnimationFrame),a.BONE in e)for(var r=e[a.BONE],s=0,o=r.length;o>s;++s)i.addBoneTimeline(this._parseBoneTimeline(r[s]));if(a.SLOT in e)for(var l=e[a.SLOT],s=0,o=l.length;o>s;++s)i.addSlotTimeline(this._parseSlotTimeline(l[s]));if(a.FFD in e)for(var h=e[a.FFD],s=0,o=h.length;o>s;++s)i.addFFDTimeline(this._parseFFDTimeline(h[s]));if(this._isOldData){if(this._isAutoTween=a._getBoolean(e,a.AUTO_TWEEN,!0),this._animationTweenEasing=a._getNumber(e,a.TWEEN_EASING,0)||0,i.playTimes=a._getNumber(e,a.LOOP,1),a.TIMELINE in e){for(var _=e[a.TIMELINE],s=0,o=_.length;o>s;++s)i.addBoneTimeline(this._parseBoneTimeline(_[s]));for(var s=0,o=_.length;o>s;++s)i.addSlotTimeline(this._parseSlotTimeline(_[s]))}}else this._isAutoTween=!1,this._animationTweenEasing=0;for(var s in this._armature.bones){var u=this._armature.bones[s];if(!i.getBoneTimeline(u.name)){var m=t.BaseObject.borrowObject(t.BoneTimelineData),f=t.BaseObject.borrowObject(t.BoneFrameData);m.bone=u,m.frames[0]=f,i.addBoneTimeline(m)}}for(var s in this._armature.slots){var c=this._armature.slots[s];if(!i.getSlotTimeline(c.name)){var d=t.BaseObject.borrowObject(t.SlotTimelineData),g=t.BaseObject.borrowObject(t.SlotFrameData);d.slot=c,g.displayIndex=c.displayIndex,c.color==t.SlotData.DEFAULT_COLOR?g.color=t.SlotFrameData.DEFAULT_COLOR:(g.color=t.SlotFrameData.generateColor(),g.color.copyFrom(c.color)),d.frames[0]=g,i.addSlotTimeline(d),this._isOldData&&(g.displayIndex=-1)}}return this._animation=null,i},n._parseBoneTimeline=function(e){var i=t.BaseObject.borrowObject(t.BoneTimelineData);i.bone=this._armature.getBone(a._getString(e,a.NAME,null)),this._parseTimeline(e,i,this._parseBoneFrame);for(var n=i.originTransform,r=null,s=0,o=i.frames.length;o>s;++s){var l=i.frames[s];r?r!=l&&l.transform.minus(n):(n.copyFrom(l.transform),l.transform.identity(),0==n.scaleX&&(n.scaleX=.001),0==n.scaleY&&(n.scaleY=.001)),r=l}return(1!=i.scale||0!=i.offset)&&(this._animation.hasAsynchronyTimeline=!0),this._isOldData&&(a.PIVOT_X in e||a.PIVOT_Y in e)?(this._timelinePivot.x=a._getNumber(e,a.PIVOT_X,0),this._timelinePivot.y=a._getNumber(e,a.PIVOT_Y,0)):this._timelinePivot.clear(),i},n._parseSlotTimeline=function(e){var i=t.BaseObject.borrowObject(t.SlotTimelineData);return i.slot=this._armature.getSlot(a._getString(e,a.NAME,null)),this._parseTimeline(e,i,this._parseSlotFrame),(1!=i.scale||0!=i.offset)&&(this._animation.hasAsynchronyTimeline=!0),i},n._parseFFDTimeline=function(e){var i=t.BaseObject.borrowObject(t.FFDTimelineData);i.skin=this._armature.getSkin(a._getString(e,a.SKIN,null)),i.slot=i.skin.getSlot(a._getString(e,a.SLOT,null));for(var n=a._getString(e,a.NAME,null),r=0,s=i.slot.displays.length;s>r;++r){var o=i.slot.displays[r];if(o.mesh&&o.name==n){i.displayIndex=r,this._mesh=o.mesh;break}}return this._parseTimeline(e,i,this._parseFFDFrame),this._mesh=null,i},n._parseAnimationFrame=function(e,i,n){var r=t.BaseObject.borrowObject(t.AnimationFrameData);return this._parseFrame(e,r,i,n),(a.ACTION in e||a.ACTIONS in e)&&this._parseActionData(e,r.actions,null,null),(a.EVENT in e||a.SOUND in e)&&this._parseEventData(e,r.events,null,null),r},n._parseBoneFrame=function(e,i,n){var r=t.BaseObject.borrowObject(t.BoneFrameData);if(r.tweenRotate=a._getNumber(e,a.TWEEN_ROTATE,0),r.tweenScale=a._getBoolean(e,a.TWEEN_SCALE,!0),this._parseTweenFrame(e,r,i,n),a.TRANSFORM in e){var s=e[a.TRANSFORM];this._parseTransform(s,r.transform),this._isOldData&&(this._helpPoint.x=this._timelinePivot.x+a._getNumber(s,a.PIVOT_X,0),this._helpPoint.y=this._timelinePivot.y+a._getNumber(s,a.PIVOT_Y,0),r.transform.toMatrix(this._helpMatrix),this._helpMatrix.transformPoint(this._helpPoint.x,this._helpPoint.y,this._helpPoint,!0),r.transform.x+=this._helpPoint.x,r.transform.y+=this._helpPoint.y)}var o=this._timeline.bone;if(a.ACTION in e||a.ACTIONS in e){var l=this._armature.getSlot(o.name),h=[];this._parseActionData(e,h,o,l),this._mergeFrameToAnimationTimeline(r,h,null)}if(a.EVENT in e||a.SOUND in e){var _=[];this._parseEventData(e,_,o,null),this._mergeFrameToAnimationTimeline(r,null,_)}return r},n._parseSlotFrame=function(e,i,n){var r=t.BaseObject.borrowObject(t.SlotFrameData);if(r.displayIndex=a._getNumber(e,a.DISPLAY_INDEX,0),this._parseTweenFrame(e,r,i,n),a.COLOR in e||a.COLOR_TRANSFORM in e?(r.color=t.SlotFrameData.generateColor(),this._parseColorTransform(e[a.COLOR]||e[a.COLOR_TRANSFORM],r.color)):r.color=t.SlotFrameData.DEFAULT_COLOR,this._isOldData)a._getBoolean(e,a.HIDE,!1)&&(r.displayIndex=-1);else if(a.ACTION in e||a.ACTIONS in e){var s=this._timeline.slot,o=[];this._parseActionData(e,o,s.parent,s),this._mergeFrameToAnimationTimeline(r,o,null)}return r},n._parseFFDFrame=function(e,i,n){var r=t.BaseObject.borrowObject(t.ExtensionFrameData);r.type=a._getNumber(e,a.TYPE,0),this._parseTweenFrame(e,r,i,n);for(var s=e[a.VERTICES],o=a._getNumber(e,a.OFFSET,0),l=0,h=0,_=0,u=this._mesh.vertices.length;u>_;_+=2)if(!s||o>_||_-o>=s.length?(l=0,h=0):(l=s[_-o]*this._armatureScale,h=s[_+1-o]*this._armatureScale),this._mesh.skinned){this._mesh.slotPose.transformPoint(l,h,this._helpPoint,!0),l=this._helpPoint.x,h=this._helpPoint.y;for(var m=this._mesh.boneIndices[_/2],f=0,c=m.length;c>f;++f){var d=m[f];this._mesh.inverseBindPose[d].transformPoint(l,h,this._helpPoint,!0),r.tweens.push(this._helpPoint.x,this._helpPoint.y)}}else r.tweens.push(l,h);return r},n._parseTweenFrame=function(e,i,n,r){this._parseFrame(e,i,n,r),i.duration>0?(a.TWEEN_EASING in e?i.tweenEasing=a._getNumber(e,a.TWEEN_EASING,t.DragonBones.NO_TWEEN):this._isOldData?i.tweenEasing=this._isAutoTween?this._animationTweenEasing:t.DragonBones.NO_TWEEN:i.tweenEasing=t.DragonBones.NO_TWEEN,this._isOldData&&1==this._animation.scale&&1==this._timeline.scale&&i.duration*this._armature.frameRate<2&&(i.tweenEasing=t.DragonBones.NO_TWEEN),a.CURVE in e&&(i.curve=t.TweenFrameData.samplingCurve(e[a.CURVE],r))):(i.tweenEasing=t.DragonBones.NO_TWEEN,i.curve=null)},n._parseFrame=function(t,e,a,i){e.position=a/this._armature.frameRate,e.duration=i/this._armature.frameRate},n._parseTimeline=function(e,i,n){if(i.scale=a._getNumber(e,a.SCALE,1),i.offset=a._getNumber(e,a.OFFSET,0),this._timeline=i,a.FRAME in e){var r=e[a.FRAME];if(r.length)if(1==r.length)i.frames.length=1,i.frames[0]=n.call(this,r[0],0,a._getNumber(r[0],a.DURATION,1));else{i.frames.length=this._animation.frameCount+1;for(var s=0,o=0,l=null,h=null,_=0,u=0,m=i.frames.length;m>_;++_){if(_>=s+o&&u<r.length){var f=r[u++];s=_,o=a._getNumber(f,a.DURATION,1),l=n.call(this,f,s,o),h&&(h.next=l,l.prev=h,this._isOldData&&h instanceof t.TweenFrameData&&-1==f[a.DISPLAY_INDEX]&&(h.tweenEasing=t.DragonBones.NO_TWEEN)),h=l}i.frames[_]=l}l.duration=this._animation.duration-l.position,l=i.frames[0],h.next=l,l.prev=h,this._isOldData&&h instanceof t.TweenFrameData&&-1==r[0][a.DISPLAY_INDEX]&&(h.tweenEasing=t.DragonBones.NO_TWEEN)}}this._timeline=null},n._parseActionData=function(e,i,n,r){var s=e[a.ACTION]||e[a.ACTIONS]||e[a.DEFAULT_ACTIONS];if("string"==typeof s){var o=t.BaseObject.borrowObject(t.ActionData);o.type=4,o.data=[s,-1,-1],o.bone=n,o.slot=r,i.push(o)}else if(s instanceof Array)for(var l=0,h=s.length;h>l;++l){var _=s[l]instanceof Array?s[l]:null,o=t.BaseObject.borrowObject(t.ActionData),u=_?null:s[l].gotoAndPlay;if(_){var m=_[0];"string"==typeof m?o.type=a._getActionType(m):o.type=a._getParameter(_,0,4)}else o.type=2;switch(o.type){case 0:o.data=[_?a._getParameter(_,1,null):u,a._getParameter(_,2,-1)];break;case 1:o.data=[_?a._getParameter(_,1,null):u];break;case 2:o.data=[_?a._getParameter(_,1,null):u,a._getParameter(_,2,0),a._getParameter(_,3,-1)];break;case 3:o.data=[_?a._getParameter(_,1,null):u,a._getParameter(_,2,0)];break;case 4:o.data=[_?a._getParameter(_,1,null):u,a._getParameter(_,2,-1),a._getParameter(_,3,-1)];break;case 5:o.data=[_?a._getParameter(_,1,null):u,a._getParameter(_,2,0)]}o.bone=n,o.slot=r,i.push(o)}},n._parseEventData=function(e,i,n,r){if(a.SOUND in e){var s=t.BaseObject.borrowObject(t.EventData);s.type=11,s.name=e[a.SOUND],s.bone=n,s.slot=r,i.push(s)}if(a.EVENT in e){var o=t.BaseObject.borrowObject(t.EventData);o.type=10,o.name=e[a.EVENT],o.bone=n,o.slot=r,a.DATA in e&&(o.data=e[a.DATA]),i.push(o)}},n._parseTransform=function(e,i){i.x=a._getNumber(e,a.X,0)*this._armatureScale,i.y=a._getNumber(e,a.Y,0)*this._armatureScale,i.skewX=a._getNumber(e,a.SKEW_X,0)*t.DragonBones.ANGLE_TO_RADIAN,i.skewY=a._getNumber(e,a.SKEW_Y,0)*t.DragonBones.ANGLE_TO_RADIAN,i.scaleX=a._getNumber(e,a.SCALE_X,1),i.scaleY=a._getNumber(e,a.SCALE_Y,1)},n._parseColorTransform=function(t,e){e.alphaMultiplier=.01*a._getNumber(t,a.ALPHA_MULTIPLIER,100),e.redMultiplier=.01*a._getNumber(t,a.RED_MULTIPLIER,100),e.greenMultiplier=.01*a._getNumber(t,a.GREEN_MULTIPLIER,100),e.blueMultiplier=.01*a._getNumber(t,a.BLUE_MULTIPLIER,100),e.alphaOffset=a._getNumber(t,a.ALPHA_OFFSET,0),e.redOffset=a._getNumber(t,a.RED_OFFSET,0),e.greenOffset=a._getNumber(t,a.GREEN_OFFSET,0),e.blueOffset=a._getNumber(t,a.BLUE_OFFSET,0)},n.parseDragonBonesData=function(e,i){if(void 0===i&&(i=1),e){var n=a._getString(e,a.VERSION,null);if(this._isOldData=n==a.DATA_VERSION_2_3||n==a.DATA_VERSION_3_0,this._isOldData?this._isGlobalTransform=a._getBoolean(e,a.IS_GLOBAL,!0):this._isGlobalTransform=!1,this._armatureScale=i,n==a.DATA_VERSION||n==a.DATA_VERSION_4_0||this._isOldData){var r=t.BaseObject.borrowObject(t.DragonBonesData);if(r.name=a._getString(e,a.NAME,null),r.frameRate=a._getNumber(e,a.FRAME_RATE,24)||24,a.ARMATURE in e){this._data=r;for(var s=e[a.ARMATURE],o=0,l=s.length;l>o;++o)r.addArmature(this._parseArmature(s[o]));this._data=null}return r}throw new Error("Nonsupport data version.")}throw new Error},n.parseTextureAtlasData=function(e,i,n){if(void 0===n&&(n=0),e){if(i.name=a._getString(e,a.NAME,null),i.imagePath=a._getString(e,a.IMAGE_PATH,null),n>0?i.scale=n:n=i.scale=a._getNumber(e,a.SCALE,i.scale),n=1/n,a.SUB_TEXTURE in e)for(var r=e[a.SUB_TEXTURE],s=0,o=r.length;o>s;++s){var l=r[s],h=i.generateTextureData();h.name=a._getString(l,a.NAME,null),h.rotated=a._getBoolean(l,a.ROTATED,!1),h.region.x=a._getNumber(l,a.X,0)*n,h.region.y=a._getNumber(l,a.Y,0)*n,h.region.width=a._getNumber(l,a.WIDTH,0)*n,h.region.height=a._getNumber(l,a.HEIGHT,0)*n;var _=a._getNumber(l,a.FRAME_WIDTH,-1),u=a._getNumber(l,a.FRAME_HEIGHT,-1);_>0&&u>0&&(h.frame=t.TextureData.generateRectangle(),h.frame.x=a._getNumber(l,a.FRAME_X,0)*n,h.frame.y=a._getNumber(l,a.FRAME_Y,0)*n,h.frame.width=_*n,h.frame.height=u*n),i.addTexture(h)}return i}throw new Error},a.getInstance=function(){return a._instance||(a._instance=new a),a._instance},a._instance=null,a}(t.DataParser);t.ObjectDataParser=e,egret.registerClass(e,"dragonBones.ObjectDataParser")}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e="during",a=function(t){function a(){t.call(this)}__extends(a,t);var i=(__define,a),n=i.prototype;return a.getComicDataFormArmatureData=function(t){return t.userData},n._parseArmature=function(a){var i=t.prototype._parseArmature.call(this,a),n={durings:[]};if(i.userData=n,i&&e in a)for(var r=a[e],s=0,o=r.length;o>s;++s){var l=r[s],h={frame:l.frame,height:l.height};n.durings.push(h)}return i},a}(t.ObjectDataParser);t.ComicDataParser=a,egret.registerClass(a,"dragonBones.ComicDataParser")}(dragonBones||(dragonBones={}));var LoadingUI=function(t){function e(){t.call(this),this.createView()}__extends(e,t);var a=(__define,e),i=a.prototype;return i.createView=function(){this.textField=new egret.TextField,this.addChild(this.textField),this.textField.y=300,this.textField.width=480,this.textField.height=100,this.textField.textAlign="center"},i.setProgress=function(t,e){this.textField.text="Loading..."+t+"/"+e},e}(egret.Sprite);egret.registerClass(LoadingUI,"LoadingUI");var Main=function(t){function e(){t.call(this),this.halfStageHeight=400,this.tempY=0,this.armeY=0,this.rePlay=[],this.nextStop=!1,this.hasDrag=!1,this.nextNum=-1,this.isLoop=!1,this.loopStart={},this.loopEnd={},this.tempI=0,this.addEventListener(egret.Event.ADDED_TO_STAGE,this.onAddToStage,this)}__extends(e,t);var a=(__define,e),i=a.prototype;return i.onAddToStage=function(t){this.stage.dirtyRegionPolicy=egret.DirtyRegionPolicy.OFF,this.loadingView=new LoadingUI,this.stage.addChild(this.loadingView),RES.addEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this),RES.loadConfig("resource/resource.json","resource/")},i.onConfigComplete=function(t){RES.removeEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.addEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),RES.loadGroup("TestArmature")},i.onResourceLoadComplete=function(t){"TestArmature"==t.groupName&&(this.stage.removeChild(this.loadingView),RES.removeEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.removeEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.removeEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),this.createGameScene())},i.onResourceLoadError=function(t){console.warn("Group:"+t.groupName+" has failed to load"),this.onResourceLoadComplete(t)},i.onResourceProgress=function(t){"TestArmature"==t.groupName&&this.loadingView.setProgress(t.itemsLoaded,t.itemsTotal)},i.createGameScene=function(){this.stage.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onTouchBegin,this),this.stage.addEventListener(egret.TouchEvent.TOUCH_MOVE,this.onTouchMove,this),this.createMotorcycleExp()},i.createMotorcycleExp=function(){this.container=new egret.DisplayObjectContainer,egret.MainContext.instance.stage.addChild(this.container);
var t=RES.getRes("skeleton_json"),e=RES.getRes("texture_json"),a=RES.getRes("texture_png"),i=new dragonBones.EgretFactory(new dragonBones.ComicDataParser);i.parseDragonBonesData(t);for(var n=0;RES.hasRes("texture_png"+n);)e=RES.getRes("texture_json"+n),a=RES.getRes("texture_png"+n),i.parseTextureAtlasData(e,a),n++;this.armature=i.buildArmature(t.armature[0].name),"Stage"==t.armature[0].type,this.armatureDisplay=this.armature.display,dragonBones.WorldClock.clock.add(this.armature),this.container.addChild(this.armatureDisplay),this.armature.animation.play(this.armature.animation.animationList[0],1),this.armature.addEventListener(dragonBones.FrameEvent.ANIMATION_FRAME_EVENT,this.stopHandler,this);var r=RES.getRes("arrow_json"),s=RES.getRes("arrowtexture_json"),o=RES.getRes("arrowtexture_png");i.parseDragonBonesData(r,"__arrow");i.parseTextureAtlasData(s,o,"__arrow"),this.arrowArmature=i.buildArmature("Armature","__arrow"),this.arrowArmatureDisplay=this.arrowArmature.display,dragonBones.WorldClock.clock.add(this.arrowArmature),this.container.addChild(this.arrowArmatureDisplay),this.arrowArmature.animation.play(this.arrowArmature.animation.animationList[0],1),this.arrowArmatureDisplay.x=.5*this.armature.armatureData.aabb.width,this.arrowArmatureDisplay.y=.8*this.armature.armatureData.aabb.height,this.arrowArmature.animation.play(),egret.Ticker.getInstance().register(function(t){dragonBones.WorldClock.clock.advanceTime(.015)},this),this.halfStageHeight=.7*this.armature.armatureData.aabb.height;var l=dragonBones.ComicDataParser.getComicDataFormArmatureData(this.armature.armatureData);for(this.maxHeight=l.durings[l.durings.length-1].height,n=0;n<l.durings.length;n++)this.rePlay[n]=!0;this.playArmature(0)},i.onTouchBegin=function(t){this.tempY=t.stageY,this.armeY=this.armatureDisplay.y},i.onTouchMove=function(t){this.armatureDisplay.y=this.armeY+(t.stageY-this.tempY),-this.armatureDisplay.y>this.maxHeight-this.armature.armatureData.aabb.height/2&&(this.armatureDisplay.y=-(this.maxHeight-this.armature.armatureData.aabb.height/2)),this.armatureDisplay.y>=0&&(this.armatureDisplay.y=0),this.tempY<t.stageY?(this.setAllPlay(),this.stopArmature(this.nextMovieClip)):(this.nextStop=!1,this.arrowArmatureDisplay.visible=!1);for(var e=this.getDuringData();0==this.rePlay[e];)e++;0>e||(this.armature.animation.isPlaying?(this.hasDrag=!0,this.nextNum<e&&(this.nextNum=e)):(this.nextNum=-1,this.hasDrag=!1,this.playArmature(e)))},i.stopArmature=function(t){if(this.armature.animation.lastAnimationState&&this.armature.animation.lastAnimationState.isPlaying)this.nextStop=!0;else{this.nextStop=!1;var e,a=dragonBones.ComicDataParser.getComicDataFormArmatureData(this.armature.armatureData),i=a.durings[t];e=0==i.frame?0:i.frame/this.armature.armatureData.frameRate,this.armature.animation.gotoAndStopByTime(this.armature.animation.animationList[0],e),this.armature.animation.stop()}},i.playArmature=function(t){var e=dragonBones.ComicDataParser.getComicDataFormArmatureData(this.armature.armatureData);this.isLoop=!1;var a=e.durings[t];if(a)if(a.height+this.armatureDisplay.y>0&&a.height+this.armatureDisplay.y<this.halfStageHeight){if(this.lastduData&&this.lastduData==a)return void(this.isLoop=!0);if(this.lastduData=a,this.rePlay[t]){var i,n;0==a.frame?(i=0,n=0):(i=a.frame/this.armature.armatureData.frameRate,n=.001),this.rePlay[t]=!1;for(var r=0;t>r;r++)this.rePlay[r]=!1;this.armature.animation.gotoAndPlayByTime(this.armature.animation.animationList[0],i+n,1)}}else this.isLoop=!0;else this.isLoop=!0},i.stopHandler=function(t){var e=t.data.name;if("stop"==e){if(this.currentEnd=t,this.armature.animation.stop(),this.nextStop)return;if(this.hasDrag)return void this.playArmature(this.nextNum);this.tempI=this.tempI+1,this.playArmature(this.tempI)}else if("loopSta"==e.substr(0,7))this.loopStart.hasOwnProperty(e.substr(9))||(this.loopStart[e.substr(9)]=t.data.frame.position);else if("loopEnd"==e.substr(0,7)&&(this.loopEnd[e.substr(7)]=t.animationState.currentTime,this.isLoop&&this.currentEnd&&this.currentEnd.data.frame.position==t.data.frame.position)){var a=this.loopStart[this.currentEnd.data.name.substr(7)];this.armature.animation.gotoAndPlayByTime(this.armature.animation.animationList[0],a+.001,1)}},i.getPlayNum=function(){for(var t=0;t<this.rePlay.length;t++)if(this.rePlay[t])return t;return this.rePlay.length},i.getDuringData=function(){var t=dragonBones.ComicDataParser.getComicDataFormArmatureData(this.armature.armatureData),e=0;for(e=0;e<t.durings.length;e++){var a=t.durings[e];if(a.height+this.armatureDisplay.y>0&&a.height+this.armatureDisplay.y<this.halfStageHeight)return this.tempI=e,e}return-1},i.setAllPlay=function(){var t=dragonBones.ComicDataParser.getComicDataFormArmatureData(this.armature.armatureData),e=0;this.nextMovieClip=0;var a=-this.armatureDisplay.y;for(e=0;e<t.durings.length;e++){var i=t.durings[e];i.height-a>this.armature.armatureData.aabb.height&&(0==this.nextMovieClip&&(this.nextMovieClip=e),this.rePlay[e]=!0)}0==this.nextMovieClip&&(this.nextMovieClip=t.durings.length-1)},e}(egret.DisplayObjectContainer);egret.registerClass(Main,"Main");